<tool id="prokka" name="Prokka" version="1.0.0">
  <description>Prokaryotic Annotation</description>
  <requirements>
    <requirement type="package" version="1.5.2">prokka</requirement>
  </requirements>
  <command interpreter="python">
    prokka.py
    ## Reads in FASTA format
    --fasta=$fasta_file
    ## Additional inputs
    --kingdom $kingdom_type.kingdom
    #if $kingdom_type.kingdom == "Bacteria"
      --gram $kingdom_type.gram
    #end if
    --minContig $minContig
    #if $rfam
      --rfam
    #end if
    #if $centre
      --centre "$centre"
    #end if
    ## Output files
    --gff=$out_gff
    --gbk=$out_gbk
    --fna=$out_fna
    --faa=$out_faa
    --ffn=$out_ffn
    --sqn=$out_sqn
    --fsa=$out_fsa
    --tbl=$out_tbl
    --err=$out_err
    --log=$out_log
  </command>
  <inputs>
    <param name="fasta_file" type="data" format="fasta" label="Contigs" help="Input dataset with contigs in FASTA format" />
    <conditional name="kingdom_type">
      <param name="kingdom" type="select" label="Kingdom (--kingdom)">
        <option value="Archaea">Archaea</option>
        <option value="Bacteria" selected="true">Bacteria</option>
        <option value="Viruses">Viruses</option>
      </param>
      <when value="Archaea" />
      <when value="Bacteria">
        <param name="gram" type="select" label="Gram (--gram)" help="If not selected, Prokka will NOT check for signal peptides">
          <option value="None">Selection is optional</option>
          <option value="pos">Positive</option>
          <option value="neg">Negative</option>
        </param>
      </when>
      <when value="Viruses" />
    </conditional>
    <param name="minContig" type="integer" value="200" label="Minimun contig size - NCBI needs 200 (--mincontig)" />
    <param name="centre" type="text" value="CRS4" label="Sequencing centre ID (--centre)" />
    <param name="rfam" type="boolean" checked="false" label="Enable searching for ncRNAs with Infernal-Rfam - SLOW (--rfam)" />
  </inputs>
  <outputs>
    <data format="gff" name="out_gff" label="${tool.name} on ${on_string}: gff"/>
    <data format="txt" name="out_gbk" label="${tool.name} on ${on_string}: gbk"/>
    <data format="fasta" name="out_fna" label="${tool.name} on ${on_string}: fna"/>
    <data format="fasta" name="out_faa" label="${tool.name} on ${on_string}: faa"/>
    <data format="fasta" name="out_ffn" label="${tool.name} on ${on_string}: ffn"/>
    <data format="asn1" name="out_sqn" label="${tool.name} on ${on_string}: sqn"/>
    <data format="fasta" name="out_fsa" label="${tool.name} on ${on_string}: fsa"/>
    <data format="txt" name="out_tbl" label="${tool.name} on ${on_string}: tbl"/>
    <data format="txt" name="out_err" label="${tool.name} on ${on_string}: err"/>
    <data format="txt" name="out_log" label="${tool.name} on ${on_string}: log"/>
  </outputs>

  <help>
**What it does**

Prokka_ is a software tool to annotate bacterial, archaeal and viral genomes very rapidly, and produce output files that require only minor tweaking to submit to Genbank/ENA/DDBJ.

.. _Prokka: http://www.vicbioinformatics.com/software.prokka.shtml

------

**Output files**

Prokka creates several output files::

 gff		This is the master annotation in GFF3 format, containing both sequences and annotations.
		It can be viewed directly in Artemis or IGV
 gbk		This is a standard Genbank file derived from the master .gff
		If the input to prokka was a multi-FASTA, then this will be a multi-Genbank,
		with one record for each sequence
 fna		Nucleotide FASTA file of the input contig sequences
 faa		Protein FASTA file of the translated CDS sequences
 ffn		Nucleotide FASTA file of all the annotated sequences, not just CDS
 sqn		An ASN1 format "Sequin" file for submission to Genbank.
		It needs to be edited to set the correct taxonomy, authors, related publication etc.
 fsa		Nucleotide FASTA file of the input contig sequences, used by "tbl2asn" to create the .sqn file.
		It is mostly the same as the .fna file, but with extra Sequin tags in the sequence description lines
 tbl		Feature Table file, used by "tbl2asn" to create the .sqn file.
 err		Unacceptable annotations - the NCBI discrepancy report.
 log		Contains all the output that Prokka produced during its run.
		This is a record of what settings you used.

------

**Prokka parameter list**

This is an exaustive list of Prokka options:

General::

  --help            This help
  --version         Print version and exit
  --docs            Show full manual/documentation
  --listdb          List all configured databases
  --citation        Print citation for referencing Prokka
  --quiet           No screen output (default OFF)

Outputs::

  --outdir [X]      Output folder [auto] (default '')
  --force           Force overwriting existing output folder (default OFF)
  --prefix [X]      Filename output prefix [auto] (default '')
  --addgenes        Add 'gene' features for each 'CDS' feature (default OFF)
  --locustag [X]    Locus tag prefix (default 'PROKKA')
  --increment [N]   Locus tag counter increment (default '1')
  --gffver [N]      GFF version (default '3')
  --centre [X]      Sequencing centre ID (default 'VBC')

Organism details::

  --genus [X]       Genus name (will be used to aid annotation) (default 'Genus')
  --species [X]     Species name (default 'species')
  --strain [X]      Strain name (default 'strain')

Annotations::

  --kingdom [X]     Annotation mode: Archaea|Bacteria|Viruses (default 'Bacteria')
  --gcode [N]       Genetic code / Translation table (set if --kingdom is set) (default '0')
  --gram [X]        Gram: -/neg +/pos (default '')
  --usegenus        Use genus-specific BLAST databases (needs --genus) (default OFF)
  --proteins [X]    FASTA file of trusted proteins to first annotate from (default '')

Computation::

  --fast            Fast mode - skip CDS /product searching (default OFF)
  --cpus [N]        Number of CPUs to use [0=all] (default '0')
  --mincontig [N]   Minimum contig size [NCBI needs 200] (default '200')
  --evalue [n.n]    Similarity e-value cut-off (default '1e-06')
  --rfam            Enable searching for ncRNAs with Infernal+Rfam (SLOW!) (default '0')

------

**License and citation**

This Galaxy tool is Copyright Â© 2013 `CRS4 Srl.`_ and is released under the `MIT license`_.

.. _CRS4 Srl.: http://www.crs4.it/
.. _MIT license: http://opensource.org/licenses/MIT

If you use this tool in Galaxy, please cite the website http://orione.crs4.it/

This tool uses `Prokka`_, which is licensed separately. Please cite Seemann T. Prokka: Prokaryotic Genome Annotation System (in preparation).

.. _Prokka: http://www.vicbioinformatics.com/software.prokka.shtml
  </help>
</tool>
