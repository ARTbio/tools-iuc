<tool id="prokka" name="Prokka" version="1.0.1">
  <description>Prokaryotic Annotation</description>
  <requirements>
    <requirement type="package" version="2.2.26+">blast+</requirement>
    <requirement type="package" version="3.1b1">hmmer</requirement>
    <requirement type="package" version="1.2.36">aragorn</requirement>
    <requirement type="package" version="1.1rc4">infernal</requirement>
    <requirement type="package" version="1.7">prokka</requirement>
  </requirements>
  <version_command>prokka --version</version_command>
  <command interpreter="python">
    prokka.py
    \${PROKKA_SITE_OPTIONS:---cpus 8}
    ## Reads in FASTA format
    --fasta=$fasta_file
    ## Additional inputs
    --kingdom $kingdom_type.kingdom
    #if str($mincontig)
      --mincontig $mincontig
    #end if
    #if $rfam
      --rfam
    #end if
    #if $centre
      --centre "$centre"
    #end if
    ## Output files
    --gff=$out_gff
    --gbk=$out_gbk
    --fna=$out_fna
    --faa=$out_faa
    --ffn=$out_ffn
    --sqn=$out_sqn
    --fsa=$out_fsa
    --tbl=$out_tbl
    --err=$out_err
    --txt=$out_txt
    --log=$out_log
  </command>
  <inputs>
    <param name="fasta_file" type="data" format="fasta" label="Contigs" help="FASTA format" />
    <conditional name="kingdom_type">
      <param name="kingdom" type="select" label="Kingdom (--kingdom)">
        <option value="Archaea">Archaea</option>
        <option value="Bacteria" selected="true">Bacteria</option>
        <option value="Viruses">Viruses</option>
      </param>
      <when value="Archaea" />
      <when value="Bacteria" />
      <when value="Viruses" />
    </conditional>
    <param name="mincontig" type="integer" value="200" optional="true" label="Minimun contig size - NCBI needs 200 (--mincontig)" />
    <param name="centre" type="text" value="CRS4" label="Sequencing centre ID (--centre)" />
    <param name="rfam" type="boolean" checked="false" label="Enable searching for ncRNAs with Infernal-Rfam - SLOW (--rfam)" />
  </inputs>
  <outputs>
    <data format="gff" name="out_gff" label="${tool.name} on ${on_string}: gff" />
    <data format="txt" name="out_gbk" label="${tool.name} on ${on_string}: gbk" />
    <data format="fasta" name="out_fna" label="${tool.name} on ${on_string}: fna" />
    <data format="fasta" name="out_faa" label="${tool.name} on ${on_string}: faa" />
    <data format="fasta" name="out_ffn" label="${tool.name} on ${on_string}: ffn" />
    <data format="asn1" name="out_sqn" label="${tool.name} on ${on_string}: sqn" />
    <data format="fasta" name="out_fsa" label="${tool.name} on ${on_string}: fsa" />
    <data format="txt" name="out_tbl" label="${tool.name} on ${on_string}: tbl" />
    <data format="txt" name="out_err" label="${tool.name} on ${on_string}: err" />
    <data format="txt" name="out_txt" label="${tool.name} on ${on_string}: txt" />
    <data format="txt" name="out_log" label="${tool.name} on ${on_string}: log" />
  </outputs>

  <help>
**What it does**

Prokka_ is a software tool to annotate bacterial, archaeal and viral genomes very rapidly, and produce output files that require only minor tweaking to submit to GenBank/ENA/DDBJ.

.. _Prokka: http://www.vicbioinformatics.com/software.prokka.shtml

**Output files**

Prokka creates several output files:

gff
    This is the master annotation in GFF3 format, containing both sequences and annotations
gbk
    This is a standard GenBank file derived from the master .gff . If the input to prokka was a multi-FASTA, then this will be a multi-GenBank, with one record for each sequence
fna
    Nucleotide FASTA file of the input contig sequences
faa
    Protein FASTA file of the translated CDS sequences
ffn
    Nucleotide FASTA file of all the annotated sequences, not just CDS
sqn
    An ASN1 format "Sequin" file for submission to GenBank. It needs to be edited to set the correct taxonomy, authors, related publication, etc.
fsa
    Nucleotide FASTA file of the input contig sequences, used by "tbl2asn" to create the .sqn file. It is mostly the same as the .fna file, but with extra Sequin tags in the sequence description lines
tbl
    Feature Table file, used by "tbl2asn" to create the .sqn file
err
    Unacceptable annotations - the NCBI discrepancy report
log
    Contains all the output that Prokka produced during its run
txt
    Statistics relating to the annotated features found

**License and citation**

This Galaxy tool is Copyright Â© 2013 `CRS4 Srl.`_ and is released under the `MIT license`_.

.. _CRS4 Srl.: http://www.crs4.it/
.. _MIT license: http://opensource.org/licenses/MIT

If you use this tool in Galaxy, please cite |Cuccuru2013|_.

.. |Cuccuru2013| replace:: Cuccuru, G., Orsini, M., Pinna, A., Sbardellati, A., Soranzo, N., Travaglione, A., Uva, P., Zanetti, G., Fotia, G. (2013) Orione, a web-based framework for NGS analysis in microbiology. *Submitted*
.. _Cuccuru2013: http://orione.crs4.it/

This tool uses `Prokka`_, which is licensed separately. Please cite Seemann T. Prokka: Prokaryotic Genome Annotation System (in preparation).

.. _Prokka: http://www.vicbioinformatics.com/software.prokka.shtml
  </help>
</tool>
