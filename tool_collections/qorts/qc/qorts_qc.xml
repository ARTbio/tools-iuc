<tool name="QoRTs" id="qorts_qc" version="1.0.0">
    <macros>
        <import>qorts_macros.xml</import>
    </macros>
    <description>quality control RNA-Seq reads</description>
    <command><![CDATA[
        mkdir output_qc
        @QORTS_INVOCATION@
        QC "${input_dataset}" "${gff_file}" output_qc --noGzipOutput
        --runFunctions $functions 
        ]]>
    </command>
    <inputs>
        <param format="sam,bam" label="SAM or BAM file to QC" name="input_dataset" type="data" />
        <param name="functions" type="select" multiple="True" display="checkboxes" label="Functions to execute" help="--runFunctions">
            <option selected="True" value="NVC">Nucleotide-vs-Cycle counts</option>
            <option selected="True" value="GCDistribution">Calculate GC content distribution</option>
            <option selected="True" value="GeneCalcs">Find gene assignment and gene body calculations</option>
            <option selected="True" value="QualityScoreDistribution">Calculate quality scores by cycle</option>
            <option selected="True" value="writeJunctionSeqCounts">Write counts file designed for use with JunctionSeq</option>
            <option selected="True" value="writeKnownSplices">Write known splice junction counts</option>
            <option selected="True" value="writeNovelSplices">Write novel splice junction counts</option>
            <option selected="True" value="writeClippedNVC">Write NVC file containing clipped sequences</option>
            <option selected="True" value="CigarOpDistribution">Cigar operation rates by cycle and cigar operation length rates</option>
            <option selected="True" value="InsertSize">Insert size distribution</option>
            <option selected="True" value="chromCounts">Calculate chromosome counts</option>
            <option selected="True" value="writeGenewiseGeneBody">Write file containing gene-body distributions for each gene</option>
            <option selected="True" value="JunctionCalcs">Find splice junctions</option>
            <option selected="True" value="writeGeneCounts">Write extended gene-level read/read-pair counts file</option>
            <option selected="True" value="writeDESeq">Write gene-level read/read-pair counts for use with DESeq, EdgeR, etc</option>
            <option selected="True" value="writeDEXSeq">Write exon-level read/read-pair counts file, designed for use with DEXSeq</option>
            <option selected="True" value="writeGeneBody">Write gene-body distribution file</option>
            <option selected="True" value="StrandCheck">Check the strandedness of the data</option>
            <option selected="True" value="annotatedSpliceExonCounts">Write counts for exons, known-splice-junctions, and genes</option>
            <option selected="True" value="FPKM">Write FPKM values</option>
            <option value="makeJunctionBed">Write splice-junction count "bed" files. (default: OFF)</option>
            <option value="makeWiggles">Write "wiggle" coverage files with 100-bp window size (default: OFF)</option>
            <option value="makeAllBrowserTracks">Write both the "wiggle" and the splice-junction bed files (default: OFF)</option>
        </param>
    </inputs>
</tool>