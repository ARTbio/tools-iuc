<tool id="gatk4_mutect2" name="GATK4 Mutect2" version="@WRAPPER_VERSION@0" profile="18.05">
    <description>- Call somatic SNVs and indels via local assembly of haplotypes</description>
    <macros>
        <import>macros.xml</import>
    </macros>
    <expand macro="requirements"/>
    <expand macro="version_cmd"/>
    <command detect_errors="exit_code">
        <![CDATA[
        #include source=$set_sections#
        #include source=$pre_gatk_excl_ints_chth#
        #include source=$bam_index_pre_chth#
        #include source=$pre_gatk_ints_chth#

        #set ref_flag='--reference="reference.fa"'

        #if str($reference_source.reference_source_selector) == 'history'
            ln -s '$reference_source.reference_sequence' reference.fa &&
            samtools faidx reference.fa &&
            gatk CreateSequenceDictionary --REFERENCE="reference.fa" --OUTPUT="reference.dict" &&
        #else if str($reference_source.reference_source_selector) == 'history'
            ln -s '$reference_source.reference_sequence.fields.path' reference.fa &&
            samtools faidx reference.fa &&
            gatk CreateSequenceDictionary --REFERENCE="reference.fa" --OUTPUT="reference.dict" &&
        #else
            #set ref_flag=''
        #end if

        #if str($outputs.output_parameters) == 'yes'
            #if str($outputs.debug_activity) == 'yes'
                ln -s '$activity_profile_out' activity-profile.tab &&
            #end if
            #if str($outputs.debug_assembly) == 'yes'
                ln -s '$assembly_region_out' assembly-region.tab &&
            #end if
            #if str($outputs.debug_bam) == 'yes'
                ln -s '$bam_output' debug.bam &&
            #end if
        #end if

        @CMD_BEGIN@ GetSampleName --input="input.bam" --output="samplename.txt" &&
        sample=`cat samplename.txt` &&

        #if str($optional.optional_parameters) == 'yes'
            #if $optional.panel_of_normals
                #set datatype = $optional.panel_of_normals.datatype
                #if $optional.panel_of_normals.is_of_type("vcf_bgzip")
                    ln -s '$optional.panel_of_normals' panel_of_normals.vcf.gz &&
                    tabix panel_of_normals.vcf.gz &&
                #else
                    ln -s '$optional.panel_of_normals' panel_of_normals.vcf &&
                #end if
            #end if

            #if $optional.germline_resource
                #set datatype = $optional.germline_resource.datatype
                #if $optional.germline_resource.is_of_type("vcf_bgzip")
                    ln -s '$optional.germline_resource' germline_resource.vcf.gz &&
                    tabix germline_resource.vcf.gz &&
                #else
                    ln -s '$optional.germline_resource' germline_resource.vcf &&
                #end if
            #end if

            #if $optional.population_callset
                #set datatype = $optional.population_callset.datatype
                #if $optional.population_callset.is_of_type("vcf_bgzip")
                    ln -s '$optional.population_callset' population_callset.vcf.gz &&
                    tabix population_callset.vcf.gz &&
                #else
                    ln -s '$optional.population_callset' population_callset.vcf &&
                #end if
            #end if

            #if $optional.alleles
                #set datatype = $optional.alleles.datatype
                #if $optional.alleles.is_of_type("vcf_bgzip")
                    ln -s '$optional.alleles' alleles.vcf.gz &&
                    tabix alleles.vcf.gz &&
                    @CMD_BEGIN@ IndexFeatureFile --feature-file alleles.vcf.gz &&
                #else
                    ln -s '$optional.alleles' alleles.vcf &&
                    @CMD_BEGIN@ IndexFeatureFile --feature-file alleles.vcf &&
                #end if
            #end if

        #end if

        @CMD_BEGIN@ Mutect2 --QUIET $ref_flag --tumor-sample \$sample

        #include source=$gatk_bam_input#

        ## COMMON PARAMETERS ##

        #if str($common.common_parameters) == 'yes'

            #if $common.read_filter
                #for $filter in str($common.read_filter).split(',')
                    --read-filter="$filter"
                #end for
            #end if

            #if $common.disable_read_filter
                #for $filter in str($common.disable_read_filter).split(',')
                    --disable-read-filter="$filter"
                #end for
            #end if

            --verbosity="ERROR"
            --read-validation-stringency="$common.read_validation_stringency"
            --interval-set-rule="$common.interval_set_rule"
            $common.lenient
            $common.disable_tool_default_read_filters
            $common.add_output_sam_program_record
            $common.add_output_vcf_command_line

        #end if

        ## END COMMON PARAMETERS ##

        ## OPTIONAL PARAMETERS ##

        #if str($optional.optional_parameters) == 'yes'

            #if $optional.panel_of_normals
                #if $optional.panel_of_normals.is_of_type("vcf_bgzip")
                    --panel-of-normals panel_of_normals.vcf.gz
                #else
                    --panel-of-normals panel_of_normals.vcf
                #end if
            #end if

            #if $optional.pedigree
                --pedigree="$optional.pedigree"
            #end if

            #if $optional.germline_resource
                #if $optional.germline_resource.is_of_type("vcf_bgzip")
                    --germline-resource germline_resource.vcf.gz
                #else
                    --germline-resource germline_resource.vcf
                #end if
            #end if

            #if $optional.annotation
                #for $annot in str($optional.annotation).split(',')
                    --annotation="$annot"
                #end for
            #end if

            #if $optional.annotation_group
                #for $annot in str($optional.annotation_group).split(',')
                    --annotation-group="$annot"
                #end for
            #end if

            #if $optional.annotations_to_exclude
                #for $annot in str($optional.annotations_to_exclude).split(',')
                    --annotations-to-exclude="$annot"
                #end for
            #end if

            #if $optional.founder_id
                --founder-id="$optional.founder_id"
            #end if

            #if $optional.normal_sample
                --normal-sample="$optional.normal_sample"
            #end if

            #if $optional.alleles
                --alleles alleles.vcf
            #end if

            --base-quality-score-threshold="$optional.base_quality_score_threshold"
            --af-of-alleles-not-in-resource="$optional.af_of_alleles_not_in_resource"
            --downsampling-stride="$optional.downsampling_stride"
            --gcs-max-retries="$optional.gcs_max_retries"
            --initial-tumor-lod="$optional.initial_tumor_lod"
            --interval-merging-rule="$optional.interval_merging_rule"
            --max-population-af="$optional.max_population_af"
            --max-reads-per-alignment-start="$optional.max_reads_per_alignment_start"
            --min-base-quality-score="$optional.min_base_quality_score"
            --native-pair-hmm-threads="\${GALAXY_SLOTS:-1}"
            --normal-lod="$optional.normal_lod"
            --tumor-lod-to-emit="$optional.tumor_lod_to_emit"
            $optional.annotate_with_num_discovered_alleles
            $optional.disable_bam_index_caching
            $optional.disable_sequence_dictionary_validation
            $optional.genotype_germline_sites
            $optional.genotype_pon_sites
            $optional.native_pair_hmm_use_double_precision
            $optional.sites_only_vcf_output
            $optional.use_new_qual_calculator
        #end if

        ## END OPTIONAL PARAMETERS ##

        ## ADVANCED PARAMETERS ##

        #if str($advanced.advanced_parameters) == 'yes'

            #if $advanced.input_prior
                --input-prior="$advanced.input_prior"
            #end if

            #if $advanced.kmer_size
                --kmer-size="$advanced.kmer_size"
            #end if

            --active-probability-threshold="$advanced.active_probability_threshold"
            --assembly-region-padding="$advanced.assembly_region_padding"
            --bam-writer-type="$advanced.bam_writer_type"
            --max-assembly-region-size="$advanced.max_assembly_region_size"
            --max-mnp-distance="$advanced.max_mnp_distance"
            --max-num-haplotypes-in-population="$advanced.max_num_haplotypes_in_population"
            --max-prob-propagation-distance="$advanced.max_prob_propagation_distance"
            --max-suspicious-reads-per-alignment-start="$advanced.max_suspicious_reads_per_alignment_start"
            --min-assembly-region-size="$advanced.min_assembly_region_size"
            --min-dangling-branch-length="$advanced.min_dangling_branch_length"
            --min-pruning="$advanced.min_pruning"
            --num-pruning-samples="$advanced.num_pruning_samples"
            --pair-hmm-gap-continuation-penalty="$advanced.pair_hmm_gap_continuation_penalty"
            --pair-hmm-implementation="$advanced.pair_hmm_implementation"
            --pcr-indel-model="$advanced.pcr_indel_model"
            --phred-scaled-global-read-mismapping-rate="$advanced.phred_scaled_global_read_mismapping_rate"
            --smith-waterman="$advanced.smith_waterman"
            $advanced.all_site_pls
            $advanced.allow_non_unique_kmers_in_ref
            $advanced.consensus
            $advanced.disable_tool_default_annotations
            $advanced.do_not_run_physical_phasing
            $advanced.dont_increase_kmer_sizes_for_cycles
            $advanced.dont_trim_active_regions
            $advanced.dont_use_soft_clipped_bases
            $advanced.enable_all_annotations
            $advanced.genotype_filtered_alleles
            $advanced.use_filtered_reads_for_annotations

        #end if

        ## END ADVANCED PARAMETERS ##

        ## ADDITIONAL OUTPUT PARAMETERS ##

        #if str($outputs.output_parameters) == 'yes'
            #if str($outputs.debug_activity) == 'yes'
                --activity-profile-out="activity-profile.tab"
            #end if
            #if str($outputs.debug_assembly) == 'yes'
                --assembly-region-out="assembly-region.tab"
            #end if
            #if str($outputs.debug_bam) == 'yes'
                --bam-output="debug.bam"
            #end if
        #end if

        #include source=$gatk_excl_ints_chth#
        #include source=$gatk_ints_chth#
        #include source=$vcf_output_opts#
        #include source=$gatk_seqdict#
        ]]>
    </command>
    <inputs>
        <expand macro="gatk_bam_req_params"/>
        <expand macro="gzip_vcf_params"/>
        <expand macro="ref_sel"/>
        <conditional name="common">
            <param name="common_parameters" type="select" label="Common parameters">
                <option value="no">Use internal defaults</option>
                <option value="yes">Specify parameters</option>
            </param>
            <when value="yes">
                <expand macro="gatk_excl_ints"/>
                <expand macro="seq_dict_sel"/>
                <param name="add_output_sam_program_record" argument="--add-output-sam-program-record" type="boolean" truevalue="--add-output-sam-program-record" falsevalue="" optional="true" checked="true" label="Add Output Sam Program Record" help="If true, adds a PG tag to created SAM/BAM/CRAM files."/>
                <param name="add_output_vcf_command_line" argument="--add-output-vcf-command-line" type="boolean" truevalue="--add-output-vcf-command-line" falsevalue="" optional="true" checked="true" label="Add Output Vcf Command Line" help="If true, adds a command line header line to created VCF files."/>
                <param name="disable_read_filter" argument="--disable-read-filter" type="select" multiple="true" value="" label="Disable Read Filter" help="Read filters to be disabled before analysis">
                    <option value="GoodCigarReadFilter">Good cigar string</option>
                    <option value="MappedReadFilter">Mapped read</option>
                    <option value="MappingQualityAvailableReadFilter">Mapping quality available</option>
                    <option value="MappingQualityNotZeroReadFilter">Mapping quality not zero</option>
                    <option value="NonChimericOriginalAlignmentReadFilter">Non-chimeric original alignment</option>
                    <option value="NonZeroReferenceLengthAlignmentReadFilter">Non-zero reference length alignment</option>
                    <option value="NotDuplicateReadFilter">Not a duplicate read</option>
                    <option value="NotSecondaryAlignmentReadFilter">Not a secondary alignment</option>
                    <option value="PassesVendorQualityCheckReadFilter">Passes vendor quality check</option>
                    <option value="WellformedReadFilter">Well-formed read</option>
                </param>
                <param name="disable_tool_default_read_filters" argument="--disable-tool-default-read-filters" type="boolean" truevalue="--disable-tool-default-read-filters" falsevalue="" optional="true" checked="false" label="Disable Tool Default Read Filters" help="Disable all tool default read filters (WARNING: many tools will not function correctly without their default read filters on)"/>
                <param name="interval_set_rule" argument="--interval-set-rule" type="select" optional="true" label="Interval Set Rule" help="Set merging approach to use for combining interval inputs">
                    <option selected="true" value="UNION">Union</option>
                    <option value="INTERSECTION">Intersection</option>
                </param>
                <param name="lenient" argument="--lenient" type="boolean" truevalue="--lenient" falsevalue="" optional="true" checked="false" label="Lenient" help="Lenient processing of VCF files"/>
                <param name="read_filter" argument="--read-filter" type="select" multiple="true" value="" label="Read Filter" help="Read filters to be applied before analysis">
                    <option value="AlignmentAgreesWithHeaderReadFilter">Alignment agrees with header</option>
                    <option value="AllowAllReadsReadFilter">Allow all reads</option>
                    <option value="AmbiguousBaseReadFilter">Ambiguous base</option>
                    <option value="CigarContainsNoNOperator">Cigar contains no NO operator</option>
                    <option value="FirstOfPairReadFilter">First of pair</option>
                    <option value="GoodCigarReadFilter">Good cigar string</option>
                    <option value="HasReadGroupReadFilter">Has read group</option>
                    <option value="MappedReadFilter">Mapped read</option>
                    <option value="MappingQualityAvailableReadFilter">Mapping quality available</option>
                    <option value="MappingQualityNotZeroReadFilter">Mapping quality not zero</option>
                    <option value="MatchingBasesAndQualsReadFilter">Matching bases and quals</option>
                    <option value="MateDifferentStrandReadFilter">Mate different strand</option>
                    <option value="MateOnSameContigOrNoMappedMateReadFilter">Mate on same contig or no mapped mate</option>
                    <option value="MateUnmappedAndUnmappedReadFilter">Mate unmapped and mapped</option>
                    <option value="MetricsReadFilter">Metrics</option>
                    <option value="NonChimericOriginalAlignmentReadFilter">Non-chimeric original alignment</option>
                    <option value="NonZeroFragmentLengthReadFilter">Non-zero fragment length</option>
                    <option value="NonZeroReferenceLengthAlignmentReadFilter">Non-zero reference length alignment</option>
                    <option value="NotDuplicateReadFilter">Not duplicate</option>
                    <option value="NotOpticalDuplicateReadFilter">Not optical duplicate</option>
                    <option value="NotSecondaryAlignmentReadFilter">Not a secondary alignment</option>
                    <option value="NotSupplementaryAlignmentReadFilter">Not a supplementary alignment</option>
                    <option value="OverclippedReadFilter">Overclipped</option>
                    <option value="PairedReadFilter">Paired</option>
                    <option value="PassesVendorQualityCheckReadFilter">Passes vendor quality check</option>
                    <option value="PrimaryLineReadFilter">Primary line</option>
                    <option value="ProperlyPairedReadFilter">Properly paired</option>
                    <option value="ReadLengthEqualsCigarLengthReadFilter">Read length equals cigar length</option>
                    <option value="SecondOfPairReadFilter">Second of pair</option>
                    <option value="SeqIsStoredReadFilter">Sequence is stored</option>
                    <option value="SoftClippedReadFilter">Soft clipped</option>
                    <option value="ValidAlignmentStartReadFilter">Valid alignment start</option>
                    <option value="ValidAlignmentEndReadFilter">Valid alignment end</option>
                    <option value="WellformedReadFilter">Well-formed read</option>
                </param>
                <param name="read_validation_stringency" argument="--read-validation-stringency" type="select" optional="true" label="Read Validation Stringency" help="Validation stringency for all SAM/BAM/CRAM/SRA files read by this program.  The default stringency value SILENT can improve performance when processing a BAM file in which variable-length data (read, qualities, tags) do not otherwise need to be decoded.">
                    <option selected="true" value="SILENT">Silent</option>
                    <option value="STRICT">Strict</option>
                    <option value="LENIENT">Lenient</option>
                </param>
            </when>
            <when value="no" />
        </conditional>
        <conditional name="optional">
            <param name="optional_parameters" type="select" label="Optional parameters">
                <option value="no">Use internal defaults</option>
                <option value="yes">Specify parameters</option>
            </param>
            <when value="yes">
                <expand macro="gatk_ints"/>
                <param name="af_of_alleles_not_in_resource" argument="--af-of-alleles-not-in-resource" type="float" optional="true" value="-1.0" label="Af Of Alleles Not In Resource" help="Population allele fraction assigned to alleles not found in germline resource.  Please see docs/mutect/mutect2.pdf fora derivation of the default value."/>
                <param name="annotate_with_num_discovered_alleles" argument="--annotate-with-num-discovered-alleles" type="boolean" truevalue="--annotate-with-num-discovered-alleles" falsevalue="" optional="true" checked="false" label="Annotate With Num Discovered Alleles" help="If provided, we will annotate records with the number of alternate alleles that were discovered (but not necessarily genotyped) at a given site"/>
                <param argument="--annotation" type="select" multiple="true" label="Annotations" help="One or more specific annotations to add to variant calls">
                    <option value="AlleleFraction">AlleleFraction</option>
                    <option value="AS_BaseQualityRankSumTest">AS_BaseQualityRankSumTest</option>
                    <option value="AS_FisherStrand">AS_FisherStrand</option>
                    <option value="AS_InbreedingCoeff">AS_InbreedingCoeff</option>
                    <option value="AS_MappingQualityRankSumTest">AS_MappingQualityRankSumTest</option>
                    <option value="AS_QualByDepth">AS_QualByDepth</option>
                    <option value="AS_ReadPosRankSumTest">AS_ReadPosRankSumTest</option>
                    <option value="AS_RMSMappingQuality">AS_RMSMappingQuality</option>
                    <option value="AS_StrandOddsRatio">AS_StrandOddsRatio</option>
                    <option value="BaseQuality">BaseQuality</option>
                    <option value="BaseQualityHistogram">BaseQualityHistogram</option>
                    <option value="BaseQualityRankSumTest">BaseQualityRankSumTest</option>
                    <option value="ChromosomeCounts">ChromosomeCounts</option>
                    <option value="ClippingRankSumTest">ClippingRankSumTest</option>
                    <option value="CountNs">CountNs</option>
                    <option value="Coverage">Coverage</option>
                    <option value="DepthPerAlleleBySample">DepthPerAlleleBySample</option>
                    <option value="DepthPerSampleHC">DepthPerSampleHC</option>
                    <option value="ExcessHet">ExcessHet</option>
                    <option value="FisherStrand">FisherStrand</option>
                    <option value="FragmentLength">FragmentLength</option>
                    <option value="GenotypeSummaries">GenotypeSummaries</option>
                    <option value="InbreedingCoeff">InbreedingCoeff</option>
                    <option value="LikelihoodRankSumTest">LikelihoodRankSumTest</option>
                    <option value="MappingQuality">MappingQuality</option>
                    <option value="MappingQualityRankSumTest">MappingQualityRankSumTest</option>
                    <option value="MappingQualityZero">MappingQualityZero</option>
                    <option value="OrientationBiasReadCounts">OrientationBiasReadCounts</option>
                    <option value="OriginalAlignment">OriginalAlignment</option>
                    <option value="PossibleDeNovo">PossibleDeNovo</option>
                    <option value="QualByDepth">QualByDepth</option>
                    <option value="ReadPosition">ReadPosition</option>
                    <option value="ReadPosRankSumTest">ReadPosRankSumTest</option>
                    <option value="ReferenceBases">ReferenceBases</option>
                    <option value="RMSMappingQuality">RMSMappingQuality</option>
                    <option value="SampleList">SampleList</option>
                    <option value="StrandBiasBySample">StrandBiasBySample</option>
                    <option value="StrandOddsRatio">StrandOddsRatio</option>
                    <option value="TandemRepeat">TandemRepeat</option>
                    <option value="UniqueAltReadCount">UniqueAltReadCount</option>
                </param>
                <param name="annotation_group" argument="--annotation-group" type="select" multiple="true" label="Annotation groups" help="One or more annotation groups to add to variant calls">
                    <option value="AlleleSpecificAnnotation">AlleleSpecificAnnotation</option>
                    <option value="AS_StandardAnnotation">AS_StandardAnnotation</option>
                    <option value="ReducibleAnnotation">ReducibleAnnotation</option>
                    <option value="StandardAnnotation">StandardAnnotation</option>
                    <option value="StandardHCAnnotation">StandardHCAnnotation</option>
                    <option value="StandardMutectAnnotation">StandardMutectAnnotation</option>
                </param>
                <param name="annotations_to_exclude" argument="--annotations-to-exclude" type="select" multiple="true" label="Annotations to exclude" help="Specific annotations to exclude from variant calls">
                    <option value="AlleleFraction">AlleleFraction</option>
                    <option value="AS_BaseQualityRankSumTest">AS_BaseQualityRankSumTest</option>
                    <option value="AS_FisherStrand">AS_FisherStrand</option>
                    <option value="AS_InbreedingCoeff">AS_InbreedingCoeff</option>
                    <option value="AS_MappingQualityRankSumTest">AS_MappingQualityRankSumTest</option>
                    <option value="AS_QualByDepth">AS_QualByDepth</option>
                    <option value="AS_ReadPosRankSumTest">AS_ReadPosRankSumTest</option>
                    <option value="AS_RMSMappingQuality">AS_RMSMappingQuality</option>
                    <option value="AS_StrandOddsRatio">AS_StrandOddsRatio</option>
                    <option value="BaseQuality">BaseQuality</option>
                    <option value="BaseQualityHistogram">BaseQualityHistogram</option>
                    <option value="BaseQualityRankSumTest">BaseQualityRankSumTest</option>
                    <option value="ChromosomeCounts">ChromosomeCounts</option>
                    <option value="ClippingRankSumTest">ClippingRankSumTest</option>
                    <option value="CountNs">CountNs</option>
                    <option value="Coverage">Coverage</option>
                    <option value="DepthPerAlleleBySample">DepthPerAlleleBySample</option>
                    <option value="DepthPerSampleHC">DepthPerSampleHC</option>
                    <option value="ExcessHet">ExcessHet</option>
                    <option value="FisherStrand">FisherStrand</option>
                    <option value="FragmentLength">FragmentLength</option>
                    <option value="GenotypeSummaries">GenotypeSummaries</option>
                    <option value="InbreedingCoeff">InbreedingCoeff</option>
                    <option value="LikelihoodRankSumTest">LikelihoodRankSumTest</option>
                    <option value="MappingQuality">MappingQuality</option>
                    <option value="MappingQualityRankSumTest">MappingQualityRankSumTest</option>
                    <option value="MappingQualityZero">MappingQualityZero</option>
                    <option value="OrientationBiasReadCounts">OrientationBiasReadCounts</option>
                    <option value="OriginalAlignment">OriginalAlignment</option>
                    <option value="PossibleDeNovo">PossibleDeNovo</option>
                    <option value="QualByDepth">QualByDepth</option>
                    <option value="ReadPosition">ReadPosition</option>
                    <option value="ReadPosRankSumTest">ReadPosRankSumTest</option>
                    <option value="ReferenceBases">ReferenceBases</option>
                    <option value="RMSMappingQuality">RMSMappingQuality</option>
                    <option value="SampleList">SampleList</option>
                    <option value="StrandBiasBySample">StrandBiasBySample</option>
                    <option value="StrandOddsRatio">StrandOddsRatio</option>
                    <option value="TandemRepeat">TandemRepeat</option>
                    <option value="UniqueAltReadCount">UniqueAltReadCount</option>
                </param>
                <param name="pedigree" argument="--pedigree" type="data" optional="true" format="vcf,vcf_bgzip" label="Pedigree" help="Pedigree file for determining the population &quot;founders&quot;. If a file is provided here, a pedigree-based annotation must be added above."/>
                <param name="base_quality_score_threshold" argument="--base-quality-score-threshold" type="integer" optional="true" value="18" label="Base Quality Score Threshold" help="Base qualities below this threshold will be reduced to the minimum (6)"/>
                <param name="contamination_fraction_to_filter" argument="--contamination-fraction-to-filter" type="float" optional="true" value="0.0" label="Contamination Fraction To Filter" help="Fraction of contamination in sequencing data (for all samples) to aggressively remove"/>
                <param name="disable_bam_index_caching" argument="--disable-bam-index-caching" type="boolean" truevalue="--disable-bam-index-caching" falsevalue="" optional="true" checked="false" label="Disable Bam Index Caching" help="If true, don&amp;apos;t cache bam indexes, this will reduce memory requirements but may harm performance if many intervals are specified.  Caching is automatically disabled if there are no intervals specified."/>
                <param name="disable_sequence_dictionary_validation" argument="--disable-sequence-dictionary-validation" type="boolean" truevalue="--disable-sequence-dictionary-validation" falsevalue="" optional="true" checked="false" label="Disable Sequence Dictionary Validation" help="If specified, do not check the sequence dictionaries from our inputs for compatibility. Use at your own risk!"/>
                <param name="downsampling_stride" argument="--downsampling-stride" type="integer" optional="true" value="1" label="Downsampling Stride" help="Downsample a pool of reads starting within a range of one or more bases."/>
                <param name="founder_id" argument="--founder-id" type="text" optional="true" value="" label="Founder Id" help="Samples representing the population &amp;quot;founders&amp;quot;"/>
                <param name="gcs_max_retries" argument="--gcs-max-retries" type="integer" optional="true" value="20" label="Gcs Max Retries" help="If the GCS bucket channel errors out, how many times it will attempt to re-initiate the connection"/>
                <param name="genotype_germline_sites" argument="--genotype-germline-sites" type="boolean" truevalue="--genotype-germline-sites" falsevalue="" optional="true" checked="false" label="Genotype Germline Sites" help="(EXPERIMENTAL) Call all apparent germline site even though they will ultimately be filtered."/>
                <param name="genotype_pon_sites" argument="--genotype-pon-sites" type="boolean" truevalue="--genotype-pon-sites" falsevalue="" optional="true" checked="false" label="Genotype PoN Sites" help="Call sites in the PoN even though they will ultimately be filtered."/>
                <param name="alleles" argument="--alleles" type="data" optional="true" format="vcf" label="Alleles" help="The set of alleles at which to genotype"/>
                <param name="germline_resource" argument="--germline-resource" type="data" optional="true" format="vcf,vcf_bgzip" label="Germline Resource" help="Population vcf of germline sequencing containing allele fractions."/>
                <param name="heterozygosity" argument="--heterozygosity" type="float" optional="true" value="0.001" label="Heterozygosity" help="The expected heterozygosity value used to compute prior probability that a locus is non-reference. The default priors are for provided for humans: het = 1e-3 which means that the probability of N samples being hom-ref at a site is: 1 - sum_i_2N (het / i) Note that heterozygosity as used here is the population genetics concept: http://en.wikipedia.org/wiki/Zygosity#Heterozygosity_in_population_genetics That is, a hets value of 0.01 implies that two randomly chosen chromosomes from the population of organisms would differ from each other (one being A and the other B) at a rate of 1 in 100 bp. Note that this quantity has nothing to do with the likelihood of any given sample having a heterozygous genotype, which in the GATK is purely determined by the probability of the observed data P(D | AB) under the model that there may be a AB het genotype. The posterior probability of this AB genotype would use the het prior, but the GATK only uses this posterior probability in determining the prob. that a site is polymorphic. So changing the het parameters only increases the chance that a site will be called non-reference across all samples, but doesn't actually change the output genotype likelihoods at all, as these aren't posterior probabilities at all. The quantity that changes whether the GATK considers the possibility of a het genotype at all is the ploidy, which determines how many chromosomes each individual in the species carries."/>
                <param name="heterozygosity_stdev" argument="--heterozygosity-stdev" type="float" optional="true" value="0.01" label="Heterozygosity Stdev" help="Standard deviation of heterozygosity for SNP and indel calling."/>
                <param name="indel_heterozygosity" argument="--indel-heterozygosity" type="float" optional="true" value="0.000125" label="Indel Heterozygosity" help="Heterozygosity for indel calling.  See the GATKDocs for heterozygosity for full details on the meaning of this population genetics concept"/>
                <param name="initial_tumor_lod" argument="--initial-tumor-lod" type="float" optional="true" value="2.0" label="Initial Tumor Lod" help="LOD threshold to consider pileup active."/>
                <param name="interval_merging_rule" argument="--interval-merging-rule" type="select" optional="true" label="Interval Merging Rule" help="Interval merging rule for abutting intervals">
                    <option selected="true" value="ALL">All</option>
                    <option value="OVERLAPPING_ONLY">Overlapping only</option>
                </param>
                <param name="max_population_af" argument="--max-population-af" type="float" optional="true" value="0.01" label="Max Population Af" help="Maximum population allele frequency in tumor-only mode."/>
                <param name="max_reads_per_alignment_start" argument="--max-reads-per-alignment-start" type="integer" optional="true" value="50" label="Max Reads Per Alignment Start" help="Maximum number of reads to retain per alignment start position. Reads above this threshold will be downsampled. Set to 0 to disable."/>
                <param name="min_base_quality_score" argument="--min-base-quality-score" type="integer" optional="true" value="10" label="Min Base Quality Score" help="Minimum base quality required to consider a base for calling"/>
                <param name="native_pair_hmm_use_double_precision" argument="--native-pair-hmm-use-double-precision" type="boolean" truevalue="--native-pair-hmm-use-double-precision" falsevalue="" optional="true" checked="false" label="Native Pair Hmm Use Double Precision" help="use double precision in the native pairHmm. This is slower but matches the java implementation better"/>
                <param name="normal_lod" argument="--normal-lod" type="float" optional="true" value="2.2" label="Normal Lod" help="LOD threshold for calling normal variant non-germline."/>
                <param name="normal_sample" argument="--normal-sample" type="text" optional="true" value="" label="Normal Sample" help="BAM sample name of normal.  May be URL-encoded as output by GetSampleName with -encode argument."/>
                <param name="num_reference_samples_if_no_call" argument="--num-reference-samples-if-no-call" type="integer" optional="true" value="0" label="Num Reference Samples If No Call" help="Number of hom-ref genotypes to infer at sites not present in a panel"/>
                <param name="output_mode" argument="--output-mode" type="select" optional="true" label="Output Mode" help="Specifies which type of calls we should output">
                    <option selected="true" value="EMIT_VARIANTS_ONLY">Variants only</option>
                    <option value="EMIT_ALL_CONFIDENT_SITES">All confident sites</option>
                    <option value="EMIT_ALL_SITES">All sites</option>
                </param>
                <param name="panel_of_normals" argument="--panel-of-normals" type="data" optional="true" format="vcf,vcf_bgzip" label="Panel Of Normals" help="VCF file of sites observed in normal."/>
                <param name="sites_only_vcf_output" argument="--sites-only-vcf-output" type="boolean" truevalue="--sites-only-vcf-output" falsevalue="" optional="true" checked="false" label="Sites Only Vcf Output" help="If true, don&apos;t emit genotype fields when writing vcf file output."/>
                <param name="population_callset" argument="--population-callset" type="data" optional="true" format="" label="Population Callset" help="Callset to use in calculating genotype priors"/>
                <param name="sample_ploidy" argument="--sample-ploidy" type="integer" optional="true" value="2" label="Sample Ploidy" help="Ploidy (number of chromosomes) per sample. For pooled data, set to (Number of samples in each pool * Sample Ploidy)."/>
                <param name="sites_only_vcf_output" argument="--sites-only-vcf-output" type="boolean" truevalue="--sites-only-vcf-output" falsevalue="" optional="true" checked="false" label="Sites Only Vcf Output" help="If true, don&amp;apos;t emit genotype fields when writing vcf file output."/>
                <param name="standard_min_confidence_threshold_for_calling" argument="--standard-min-confidence-threshold-for-calling" type="float" optional="true" value="10.0" label="Standard Min Confidence Threshold For Calling" help="The minimum phred-scaled confidence threshold at which variants should be called"/>
                <param name="tumor_lod_to_emit" argument="--tumor-lod-to-emit" type="float" optional="true" value="3.0" label="Tumor Lod To Emit" help="LOD threshold to emit tumor variant to VCF."/>
                <param name="use_new_qual_calculator" argument="--use-new-qual-calculator" type="boolean" truevalue="--use-new-qual-calculator" falsevalue="" optional="true" checked="false" label="Use New Qual Calculator" help="If provided, we will use the new AF model instead of the so-called exact model"/>
            </when>
            <when value="no" />
        </conditional>
        <conditional name="advanced">
            <param name="advanced_parameters" type="select" label="Advanced parameters">
                <option value="no">Use internal defaults</option>
                <option value="yes">Specify parameters</option>
            </param>
            <when value="yes">
                <param name="active_probability_threshold" argument="--active-probability-threshold" type="float" optional="true" value="0.002" label="Active Probability Threshold" help="Minimum probability for a locus to be considered active."/>
                <param name="all_site_pls" argument="--all-site-pls" type="boolean" truevalue="--all-site-pls" falsevalue="" optional="true" checked="false" label="All Site Pls" help="Annotate all sites with PLs"/>
                <param name="allow_non_unique_kmers_in_ref" argument="--allow-non-unique-kmers-in-ref" type="boolean" truevalue="--allow-non-unique-kmers-in-ref" falsevalue="" optional="true" checked="false" label="Allow Non Unique Kmers In Ref" help="Allow graphs that have non-unique kmers in the reference"/>
                <param name="assembly_region_padding" argument="--assembly-region-padding" type="integer" optional="true" value="100" label="Assembly Region Padding" help="Number of additional bases of context to include around each assembly region"/>
                <param name="bam_writer_type" argument="--bam-writer-type" type="select" optional="true" label="Bam Writer Type" help="Which haplotypes should be written to the BAM">
                    <option selected="true" value="CALLED_HAPLOTYPES">Called haplotypes</option>
                    <option value="ALL_POSSIBLE_HAPLOTYPES">All possible haplotypes</option>
                </param>
                <param name="consensus" argument="--consensus" type="boolean" truevalue="--consensus" falsevalue="" optional="true" checked="false" label="Consensus" help="1000G consensus mode"/>
                <param name="disable_tool_default_annotations" argument="--disable-tool-default-annotations" type="boolean" truevalue="--disable-tool-default-annotations" falsevalue="" optional="true" checked="false" label="Disable Tool Default Annotations" help="Disable all tool default annotations"/>
                <param name="do_not_run_physical_phasing" argument="--do-not-run-physical-phasing" type="boolean" truevalue="--do-not-run-physical-phasing" falsevalue="" optional="true" checked="false" label="Do Not Run Physical Phasing" help="Disable physical phasing"/>
                <param name="dont_increase_kmer_sizes_for_cycles" argument="--dont-increase-kmer-sizes-for-cycles" type="boolean" truevalue="--dont-increase-kmer-sizes-for-cycles" falsevalue="" optional="true" checked="false" label="Dont Increase Kmer Sizes For Cycles" help="Disable iterating over kmer sizes when graph cycles are detected"/>
                <param name="dont_trim_active_regions" argument="--dont-trim-active-regions" type="boolean" truevalue="--dont-trim-active-regions" falsevalue="" optional="true" checked="false" label="Dont Trim Active Regions" help="If specified, we will not trim down the active region from the full region (active + extension) to just the active interval for genotyping"/>
                <param name="dont_use_soft_clipped_bases" argument="--dont-use-soft-clipped-bases" type="boolean" truevalue="--dont-use-soft-clipped-bases" falsevalue="" optional="true" checked="false" label="Dont Use Soft Clipped Bases" help="Do not analyze soft clipped bases in the reads"/>
                <param name="enable_all_annotations" argument="--enable-all-annotations" type="boolean" truevalue="--enable-all-annotations" falsevalue="" optional="true" checked="false" label="Enable All Annotations" help="Use all possible annotations (not for the faint of heart)"/>
                <param name="genotype_filtered_alleles" argument="--genotype-filtered-alleles" type="boolean" truevalue="--genotype-filtered-alleles" falsevalue="" optional="true" checked="false" label="Genotype Filtered Alleles" help="Whether to genotype all given alleles, even filtered ones, --genotyping_mode is GENOTYPE_GIVEN_ALLELES"/>
                <param name="input_prior" argument="--input-prior" type="float" optional="true" value="" label="Input Prior" help="By default, the prior specified with the heterozygosity argument is used for variant discovery at a particular locus, using an infinite sites model, see e.g. Waterson (1975) or Tajima (1996). This model asserts that the probability of having a population of k variant sites in N chromosomes is proportional to theta/k, for 1=1:N There are instances where using this prior might not be desireable, e.g. for population studies where prior might not be appropriate, as for example when the ancestral status of the reference allele is not known. By using this argument, user can manually specify priors to be used for calling as a vector for doubles, with the following restriciotns: a) User must specify 2N values, where N is the number of samples. b) Only diploid calls supported. c) Probability values are specified in double format, in linear space. d) No negative values allowed. e) Values will be added and Pr(AC=0) will be 1-sum, so that they sum up to one. f) If user-defined values add to more than one, an error will be produced. If user wants completely flat priors, then user should specify the same value (=1/(2*N+1)) 2*N times,e.g. -inputPrior 0.33 -inputPrior 0.33 for the single-sample diploid case."/>
                <param name="kmer_size" argument="--kmer-size" type="integer" optional="true" value="" label="Kmer Size" help="Kmer size to use in the read threading assembler"/>
                <param name="max_assembly_region_size" argument="--max-assembly-region-size" type="integer" optional="true" value="300" label="Max Assembly Region Size" help="Maximum size of an assembly region"/>
                <param name="max_mnp_distance" argument="--max-mnp-distance" type="integer" optional="true" value="1" label="Max Mnp Distance" help="Two or more phased substitutions separated by this distance or less are merged into MNPs."/>
                <param name="max_num_haplotypes_in_population" argument="--max-num-haplotypes-in-population" type="integer" optional="true" value="128" label="Max Num Haplotypes In Population" help="Maximum number of haplotypes to consider for your population"/>
                <param name="max_prob_propagation_distance" argument="--max-prob-propagation-distance" type="integer" optional="true" value="50" label="Max Prob Propagation Distance" help="Upper limit on how many bases away probability mass can be moved around when calculating the boundaries between active and inactive assembly regions"/>
                <param name="max_suspicious_reads_per_alignment_start" argument="--max-suspicious-reads-per-alignment-start" type="integer" optional="true" value="0" label="Max Suspicious Reads Per Alignment Start" help="Maximum number of suspicious reads (mediocre mapping quality or too many substitutions) allowed in a downsampling stride.  Set to 0 to disable."/>
                <param name="min_assembly_region_size" argument="--min-assembly-region-size" type="integer" optional="true" value="50" label="Min Assembly Region Size" help="Minimum size of an assembly region"/>
                <param name="min_dangling_branch_length" argument="--min-dangling-branch-length" type="integer" optional="true" value="4" label="Min Dangling Branch Length" help="Minimum length of a dangling branch to attempt recovery"/>
                <param name="min_pruning" argument="--min-pruning" type="integer" optional="true" value="2" label="Min Pruning" help="Minimum support to not prune paths in the graph"/>
                <param name="num_pruning_samples" argument="--num-pruning-samples" type="integer" optional="true" value="1" label="Num Pruning Samples" help="Number of samples that must pass the minPruning threshold"/>
                <param name="pair_hmm_gap_continuation_penalty" argument="--pair-hmm-gap-continuation-penalty" type="integer" optional="true" value="10" label="Pair Hmm Gap Continuation Penalty" help="Flat gap continuation penalty for use in the Pair HMM"/>
                <param name="pair_hmm_implementation" argument="--pair-hmm-implementation" type="select" optional="true" label="Pair Hmm Implementation" help="The PairHMM implementation to use for genotype likelihood calculations">
                    <option selected="true" value="FASTEST_AVAILABLE">Fastest Available</option>
                    <option value="EXACT">Exact</option>
                    <option value="ORIGINAL">Original</option>
                    <option value="LOGLESS_CACHING">Logless Caching</option>
                    <option value="AVX_LOGLESS_CACHING">Logless Caching (AVX)</option>
                    <option value="AVX_LOGLESS_CACHING_OMP">Logless Caching (AVX+OMP)</option>
                    <option value="EXPERIMENTAL_FPGA_LOGLESS_CACHING">Logless Caching (FPGA, Experimental)</option>
                </param>
                <param name="pcr_indel_model" argument="--pcr-indel-model" type="select" optional="true" label="Pcr Indel Model" help="The PCR indel model to use">
                    <option selected="true" value="CONSERVATIVE">Conservative</option>
                    <option value="NONE">None</option>
                    <option value="HOSTILE">Hostile</option>
                    <option value="AGGRESSIVE">Aggressive</option>
                </param>
                <param name="phred_scaled_global_read_mismapping_rate" argument="--phred-scaled-global-read-mismapping-rate" type="integer" optional="true" value="45" label="Phred Scaled Global Read Mismapping Rate" help="The global assumed mismapping rate for reads"/>
                <param name="smith_waterman" argument="--smith-waterman" type="select" optional="true" label="Smith Waterman" help="Which Smith-Waterman implementation to use, generally 'Fastest available' is the right choice">
                    <option selected="true" value="FASTEST_AVAILABLE">Fastest available</option>
                    <option value="AVX_ENABLED">AVX-Enabled</option>
                    <option value="JAVA">JAVA</option>
                </param>
                <param name="use_filtered_reads_for_annotations" argument="--use-filtered-reads-for-annotations" type="boolean" truevalue="--use-filtered-reads-for-annotations" falsevalue="" optional="true" checked="false" label="Use Filtered Reads For Annotations" help="Use the contamination-filtered read maps for the purposes of annotating variants"/>
            </when>
            <when value="no" />
        </conditional>
        <conditional name="outputs">
            <param name="output_parameters" type="select" label="Output parameters" help="Additional outputs for debugging purposes">
                <option value="no">Output only variants</option>
                <option value="yes">Generate debugging information</option>
            </param>
            <when value="yes">
                <param name="debug_activity" argument="--activity-profile-out" type="boolean" checked="false" truevalue="yes" falsevalue="" label="Activity Profile Out" help="Output the raw activity profile results in IGV format"/>
                <param name="debug_assembly" argument="--assembly-region-out" type="boolean" checked="false" truevalue="yes" falsevalue="" label="Assembly Region Out" help="Output the assembly region to this IGV formatted file"/>
                <param name="debug_bam" argument="--bam-output" type="boolean" checked="false" truevalue="yes" falsevalue="" label="Bam Output" help="The assembled haplotypes and locally realigned reads will be written as BAM to this file if requested. This is intended to be used only for troubleshooting purposes, in specific areas where you want to better understand why the caller is making specific calls"/>
            </when>
            <when value="no" />
        </conditional>
    </inputs>
    <outputs>
        <expand macro="gzip_vcf_output_params"/>
        <data format="tabular" name="activity_profile_out" label="${tool.name} on ${on_string}: Activity profile">
            <filter>str(outputs['output_parameters']) == 'yes' and outputs['debug_activity']</filter>
        </data>
        <data format="tabular" name="assembly_region_out" label="${tool.name} on ${on_string}: Assembly region">
            <filter>str(outputs['output_parameters']) == 'yes' and outputs['debug_assembly']</filter>
        </data>
        <data format="bam" name="bam_output" label="${tool.name} on ${on_string}: Debug BAM output">
            <filter>str(outputs['output_parameters']) == 'yes' and outputs['debug_bam']</filter>
        </data>
    </outputs>
    <tests>
        <test>
            <param name="input" ftype="bam" value="Mutect2-in1.bam" />
            <param name="reference_sequence" ftype="fasta" value="reference.fa" />
            <param name="gzipped_output" value="false" />
            <param name="reference_source_selector" value="history" />
            <param name="common_parameters" value="no" />
            <param name="optional_parameters" value="no" />
            <param name="advanced_parameters" value="no" />
            <param name="output_parameters" value="no" />
            <output name="output_vcf" file="Mutect2-out1.vcf" lines_diff="2" />
        </test>
        <test>
            <param name="input" ftype="bam" value="Mutect2-in2.bam" />
            <param name="reference_sequence" ftype="fasta" value="reference.fa" />
            <param name="gzipped_output" value="false" />
            <param name="reference_source_selector" value="history" />
            <param name="common_parameters" value="yes" />
            <param name="read_filter" value="AmbiguousBaseReadFilter,FirstOfPairReadFilter,GoodCigarReadFilter" />
            <param name="seqdict_source" value="history" />
            <param name="seqdict_sequence" value="Mutect2-in2.dict" />
            <param name="optional_parameters" value="no" />
            <param name="advanced_parameters" value="no" />
            <param name="output_parameters" value="no" />
            <output name="output_vcf" file="Mutect2-out2.vcf" lines_diff="2" />
        </test>
        <test>
            <param name="input" ftype="bam" value="Mutect2-in3.bam" />
            <param name="reference_sequence" ftype="fasta" value="reference.fa" />
            <param name="gzipped_output" value="false" />
            <param name="reference_source_selector" value="history" />
            <param name="common_parameters" value="no" />
            <param name="optional_parameters" value="yes" />
            <param name="annotation" value="StrandBiasBySample,BaseQualityHistogram,OrientationBiasReadCounts" />
            <param name="annotation_group" value="StandardMutectAnnotation" />
            <param name="advanced_parameters" value="no" />
            <param name="output_parameters" value="no" />
            <output name="output_vcf" file="Mutect2-out3.vcf" lines_diff="2" />
        </test>
        <test>
            <param name="input" ftype="bam" value="Mutect2-in4.bam" />
            <param name="reference_sequence" ftype="fasta" value="reference.fa" />
            <param name="gzipped_output" value="false" />
            <param name="reference_source_selector" value="history" />
            <param name="common_parameters" value="no" />
            <param name="optional_parameters" value="yes" />
            <param name="advanced_parameters" value="yes" />
            <param name="dont_trim_active_regions" value="true" />
            <param name="output_parameters" value="no" />
            <output name="output_vcf" file="Mutect2-out4.vcf" lines_diff="2" />
        </test>
        <test>
            <param name="input" ftype="bam" value="Mutect2-in5.bam" />
            <param name="reference_sequence" ftype="fasta" value="reference.fa" />
            <param name="gzipped_output" value="false" />
            <param name="reference_source_selector" value="history" />
            <param name="common_parameters" value="no" />
            <param name="optional_parameters" value="no" />
            <param name="advanced_parameters" value="no" />
            <param name="output_parameters" value="yes" />
            <param name="debug_activity" value="true" />
            <param name="debug_assembly" value="true" />
            <param name="debug_bam" value="true" />
            <output name="output_vcf" file="Mutect2-out5.vcf" lines_diff="2" />
            <output name="activity_profile_out" file="Mutect2-out5-1.tabular" />
            <output name="assembly_region_out" file="Mutect2-out5-2.tabular" />
            <output name="bam_output" file="Mutect2-out5.bam" />
        </test>
    </tests>
    <help><![CDATA[Call somatic short variants via local assembly of haplotypes. Short
variants include single nucleotide (SNV) and insertion and deletion
(indel) variants. The caller combines the DREAM challenge-winning
somatic genotyping engine of the original MuTect (`Cibulskis et al.,
2013 <http://www.nature.com/nbt/journal/v31/n3/full/nbt.2514.html>`__)
with the assembly-based machinery of
`HaplotypeCaller <https://www.broadinstitute.org/gatk/documentation/tooldocs/org_broadinstitute_gatk_tools_walkers_haplotypecaller_HaplotypeCaller.php>`__.

This tool is featured in the *Somatic Short Mutation calling Best
Practice Workflow*. See
`Tutorial#11136 <https://software.broadinstitute.org/gatk/documentation/article?id=11136>`__
for a step-by-step description of the workflow and
`Article#11127 <https://software.broadinstitute.org/gatk/documentation/article?id=11127>`__
for an overview of what traditional somatic calling entails. For the
latest pipeline scripts, see the `Mutect2 WDL scripts
directory <https://github.com/broadinstitute/gatk/tree/master/scripts/mutect2_wdl>`__.
Although we present the tool for somatic calling, it may apply to other
contexts, such as mitochondrial variant calling.

Usage examples
~~~~~~~~~~~~~~

Example commands show how to run Mutect2 for typical scenarios. The two
modes are (i) *somatic mode* where a tumor sample is matched with a
normal sample in analysis and (ii) *tumor-only mode* where a single
sample's alignment data undergoes analysis.

(i) Tumor with matched normal
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

Given a matched normal, Mutect2 is designed to call somatic variants
only. The tool includes logic to skip emitting variants that are clearly
present in the germline based on provided evidence, e.g. in the matched
normal. This is done at an early stage to avoid spending computational
resources on germline events. If the variant's germline status is
borderline, then Mutect2 will emit the variant to the callset for
subsequent filtering and review.

::

    gatk Mutect2 \
      -R reference.fa \
      -I tumor.bam \
      -tumor tumor_sample_name \
      -I normal.bam \
      -normal normal_sample_name \
      --germline-resource af-only-gnomad.vcf.gz \
      --af-of-alleles-not-in-resource 0.00003125 \
      --panel-of-normals pon.vcf.gz \
      -O somatic.vcf.gz


The --af-of-alleles-not-in-resource argument value should match
expectations for alleles not found in the provided germline resource.
Note the tool does not require a germline resource nor a panel of
normals (PoN) to run. The tool prefilters sites for the matched normal
and the PoN. For the germline resource, the tool prefilters on the
allele. Below is an excerpt of a known variants resource with population
allele frequencies

::

        #CHROM  POS     ID      REF     ALT     QUAL    FILTER  INFO
         1       10067   .       T       TAACCCTAACCCTAACCCTAACCCTAACCCTAACCCTAACCC      30.35   PASS    AC=3;AF=7.384E-5
         1       10108   .       CAACCCT C       46514.32        PASS    AC=6;AF=1.525E-4
         1       10109   .       AACCCTAACCCT    AAACCCT,*       89837.27        PASS    AC=48,5;AF=0.001223,1.273E-4
         1       10114   .       TAACCCTAACCCTAACCCTAACCCTAACCCTAACCCCTAACCCTAACCCTAACCCTAACCCTAACCTAACCCTAACCCTAACCCTAACCCTAACCCTAACCCTAACCCTAACCCTAACCCCTAACCCTAACCCTAAACCCTA  *,CAACCCTAACCCTAACCCTAACCCTAACCCTAACCCCTAACCCTAACCCTAACCCTAACCCTAACCTAACCCTAACCCTAACCCTAACCCTAACCCTAACCCTAACCCTAACCCTAACCCCTAACCCTAACCCTAAACCCTA,T      36728.97        PASS    AC=55,9,1;AF=0.001373,2.246E-4,2.496E-5
         1       10119   .       CT      C,*     251.23  PASS    AC=5,1;AF=1.249E-4,2.498E-5
         1       10120   .       TA      CA,*    14928.74        PASS    AC=10,6;AF=2.5E-4,1.5E-4
         1       10128   .       ACCCTAACCCTAACCCTAAC    A,*     285.71  PASS    AC=3,1;AF=7.58E-5,2.527E-5
         1       10131   .       CT      C,*     378.93  PASS    AC=7,5;AF=1.765E-4,1.261E-4
         1       10132   .       TAACCC  *,T     18025.11        PASS    AC=12,2;AF=3.03E-4,5.049E-5


(ii) Tumor-only mode
^^^^^^^^^^^^^^^^^^^^

This mode runs on a single sample, e.g. single tumor or single normal
sample. To create a PoN, call on each normal sample in this mode, then
use CreateSomaticPanelOfNormals to generate the PoN.

::

     gatk Mutect2 \
      -R reference.fa \
      -I sample.bam \
      -tumor sample_name \
      -O single_sample.vcf.gz


Further points of interest
~~~~~~~~~~~~~~~~~~~~~~~~~~

Additional parameters that factor towards filtering, including
normal-artifact-lod (default threshold 0.0) and tumor-lod (default
threshold 5.3), are available in FilterMutectCalls. While the tool
calculates normal-lod assuming a diploid genotype, it calculates
normal-artifact-lod with the same approach it uses for tumor-lod, i.e.
with a variable ploidy assumption.

- If the normal artifact log odds becomes large, then FilterMutectCalls applies the artifact-in-normal filter. For matched normal samples with tumor contamination, consider increasing the normal-artifact-lod threshold.

- The tumor log odds, which is calculated independently of any matched normal, determines whether to filter a tumor variant. Variants with tumor LODs exceeding the threshold pass filtering.


If a variant is absent from a given germline resource, then the value
for --af-of-alleles-not-in-resource applies. For example, gnomAD's
16,000 samples (~32,000 homologs per locus) becomes a probability of one
in 32,000 or less. Thus, an allele's absence from the germline resource
becomes evidence that it is not a germline variant.

Caveats
~~~~~~~

Although GATK4 Mutect2 accomodates varying coverage depths, further
optimization of parameters may improve calling for extreme high depths,
e.g. 1000X.
]]></help>
    <citations>
        <expand macro="citations"/>
    </citations>
</tool>