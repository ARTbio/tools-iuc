<macros>
    <token name="@WRAPPER_VERSION@">@TOOL_VERSION@+galaxy</token>
    <token name="@TOOL_VERSION@">2.1.3.1</token>
    <xml name="requirements">
        <requirements>
        <requirement type="package" version="@TOOL_VERSION@">lofreq</requirement>
        <requirement type="package" version="1.9">samtools</requirement>
            <yield/>
        </requirements>
    </xml>
    <xml name="citations">
        <citations>
            <citation type="doi">10.1093/nar/gks918</citation>
            <yield />
        </citations>
    </xml>
    <xml name="ref_sel">
        <conditional name="reference_source">
            <param name="ref_selector" type="select" label="Choose the source for the reference list">
                <option value="cached">Locally cached</option>
                <option value="history">History</option>
            </param>
            <when value="cached">
                <param argument="--ref" type="select" label="Reference" help="Reference sequence" >
                    <options from_data_table="all_fasta" >
                        <validator type="no_options" message="A built-in reference genome is not available for the build associated with the selected input file" />
                    </options>
                </param>
            </when>
            <when value="history">
                <param argument="--ref" type="data" format="fasta" label="Reference" help="Reference sequence" />
            </when>
        </conditional>
    </xml>
    <token name="@REF_COMMAND@">
<![CDATA[        #if str($reference_source.ref_selector) == 'history'
    ln -s '$reference_source.ref' reference.fa &&
#else
    ln -s '$reference_source.ref.fields.path' reference.fa &&
#end if
samtools faidx reference.fa &&
]]>
    </token>
</macros>