<?xml version='1.0' encoding='utf-8'?>
<tool name="bcftools @EXECUTABLE@" id="bcftools_@EXECUTABLE@" version="@VERSION@.0">
  <description>Concatenate or combine VCF/BCF files</description>
  <macros>
    <token name="@EXECUTABLE@">concat</token>
    <import>macros.xml</import>
  </macros>
  <expand macro="requirements" />
  <expand macro="stdio" />
  <expand macro="version_command" />
  <command>bcftools @EXECUTABLE@

## Default section
${sec_default.allow_overlaps}
${sec_default.remove_duplicates}

${sec_default.ligate}
#if $sec_default.min_PQ:
  --min-PQ "${sec_default.min_PQ}"
#end if
#if str($sec_default.select_output_type) != "__none__":
  --output-type "${sec_default.select_output_type}"
#end if

@SEC_DEF_REGIONS@

## Primary Input/Outputs
$input_file1

#for file in $input_file2:
    $input_file2
#end for

> $output_file

</command>
  <inputs>
    <param name="input_file1" label="VCF/BCF Data" type="data" format="vcf,bcf" />
    <param name="input_file2" label="Other VCF/BCF Datasets" type="data" format="vcf,bcf" multiple="True" />
    <section name="sec_default" expanded="true" title="Default Options">
      <param name="allow_overlaps" label="Allow Overlaps" type="boolean" truevalue="--allow-overlaps" falsevalue="" help="First coordinate of the next file can precede last record of the current file." argument="--allow-overlaps" />
      <param name="remove_duplicates" label="Remove Duplicates" type="boolean" truevalue="--remove-duplicates" falsevalue="" help="Output only once records present in multiple files." argument="--remove-duplicates"/>
      <param name="ligate" label="Ligate" type="boolean" truevalue="--ligate" falsevalue="" help="Ligate phased VCFs by matching phase at overlapping haplotypes" argument="--ligate"/>
      <param name="min_PQ" label="Min PQ" type="integer" default="30" optional="True" help="Break phase set if phasing quality is lower than &lt;int&gt;" argument="--min-PQ" />
      <expand macro="macro_select_output_type" />
      <expand macro="macro_regions" />
    </section>
  </inputs>
  <outputs>
    <data name="output_file" format="vcf">
      <expand macro="sec_def_output_type" />
    </data>
  </outputs>
  <tests>
    <test>
      <param name="input_file1" value="concat.1.a.bcf" />
      <param name="input_file2" value="concat.1.b.bcf" />
      <output name="output_file" file="concat.1.bcf.out" lines_diff="6"/>
    </test>
    <test>
      <param name="input_file1" value="concat.2.a.bcf" />
      <param name="input_file2" value="concat.2.b.bcf" />
      <param name="allow_overlaps" value="--allow-overlaps" />
      <output name="output_file" file="concat.2.bcf.out" lines_diff="6"/>
    </test>
    <test>
    <param/>
      <param name="input_file1" value="concat.3.a.bcf" />
      <param name="input_file2" value="concat.3.b.bcf concat.3.0.bcf concat.3.c.bcf concat.3.d.bcf concat.3.e.bcf concat.3.f.bcf" />
      <param name="ligate" value="--ligate" />
      <output name="output_file" file="concat.3.bcf.out" lines_diff="6"/>
    </test>
    <test>
      <param name="input_file1" value="concat.2.a.bcf" />
      <param name="input_file2" value="concat.2.b.bcf" />
      <param name="allow_overlaps" value="--allow-overlaps" />
      <param name="remove_duplicates" value="--remove-duplicates" />
      <output name="output_file" file="concat.4.bcf.out" lines_diff="6"/>
    </test>
  </tests>
  <help><![CDATA[
bcftools concat
===============

Concatenate or combine VCF/BCF files. All source files must have the same
sample columns appearing in the same order. Can be used, for example, to
concatenate chromosome VCFs into one VCF, or combine a SNP VCF and an
indel VCF into one. The input files must be sorted by chr and position.
The files must be given in the correct order to produce sorted VCF on
output unless the -a, --allow-overlaps option is specified.


@OUTPUT_TYPE_HELP@
@REGIONS_HELP@
  ]]></help>
  <expand macro="citations" />
</tool>
