<tool id="rseqc_read_GC" name="Read GC" version="@WRAPPER_VERSION@">
    <description>determines GC% and read count</description>

    <macros>
        <import>rseqc_macros.xml</import>
    </macros>

    <expand macro="requirements" />

    <expand macro="stdio" />

    <version_command><![CDATA[read_GC.py --version]]></version_command>

    <command><![CDATA[
        read_GC.py
            --input-file '${input}'
            --out-prefix output
            --mapq ${mapq}
        ]]>
    </command>

    <inputs>
        <param name="input" type="data" format="bam,sam" label="input bam/sam file" help="(--input-file)"/>
        <param name="mapq" type="integer" label="Minimum mapping quality (default=30)" help="Minimum phred scale mapping quality to consider a read 'uniquely mapped' (--mapq)" value="30" />
    </inputs>

    <outputs>
        <data format="xls" name="outputxls" from_work_dir="output.GC.xls" label="${tool.name} on ${on_string} (XLS)"/>
        <data format="txt" name="outputr" from_work_dir="output.GC_plot.r" label="${tool.name} on ${on_string} (R Script)" />
        <data format="pdf" name="outputpdf" from_work_dir="output.GC_plot.pdf" label="${tool.name} on ${on_string} (PDF)" />
    </outputs>

    <tests>
        <test>
            <param name="input" value="pairend_strandspecific_51mer_hg19_chr1_1-100000.bam" />
            <output name="outputxls" file="output.GC.xls" />
            <output name="outputr" file="output.GC_plot.r" />
            <output name="outputpdf" file="output.GC_plot.pdf" compare="sim_size" />
        </test>
    </tests>

    <help><![CDATA[
read_GC.py
++++++++++


Inputs
++++++++++++++

Input BAM/SAM file
    Alignment file in BAM/SAM format.

Output
++++++++++++++

1. output.GC.xls: Two column, plain text file, first column is GC%, second column is read count
2. output.GC_plot.r: R script to generate pdf file.
3. output.GC_plot.pdf: graphical output generated from R script.

.. image:: http://rseqc.sourceforge.net/_images/read_gc.png
   :height: 600 px
   :width: 600 px
   :scale: 80 %

@ABOUT@

]]>
    </help>

    <expand macro="citations" />

</tool>
