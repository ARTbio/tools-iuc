<tool id="rseqc_RNA_fragment_size" name="RNA fragment size" version="@WRAPPER_VERSION@">
    <description>
     calculates the fragment size for each gene/transcript
    </description>

    <macros>
        <import>rseqc_macros.xml</import>
    </macros>

    <expand macro="requirements" />

    <expand macro="stdio" />

    <version_command><![CDATA[RNA_fragment_size.py --version]]></version_command>

    <command><![CDATA[
        ln -f -s '${input}' 'input.bam' &&
        ln -f -s '$input.metadata.bam_index' 'input.bam.bai' &&
        RNA_fragment_size.py -i 'input.bam' --refgene='${refgene}' --mapq=${mapq} --frag-num=${fragnum} > '${output}'
        ]]>
    </command>

    <inputs>
        <param name="input" type="data" label="Input .bam File" format="bam" help="(--input-file)"/>
        <param name="refgene" type="data" format="bed" label="reference gene model" help="(--refgene)"/>
        <param name="mapq" type="integer" label="Minimum mapping quality for an alignment to be considered as &quot;uniquely mapped&quot;." value="30" help="(--mapq)"/>
        <param name="fragnum" type="integer" value="3" label="Minimum number of fragments (default: 3)" help="(--frag-num)." />
    </inputs>

    <outputs>
        <data format="tabular" name="output" />
    </outputs>

    <tests>
        <test>
            <param name="input" value="pairend_strandspecific_51mer_hg19_chr1_1-100000.bam" />
            <param name="refgene" value="hg19_RefSeq_chr1_1-100000.bed" />
            <output name="output" file="output.RNA_fragment_size.txt" />
        </test>
    </tests>

    <help><![CDATA[
RNA_fragment_size.py
++++++++++++++++++++

Calculate fragment size for each gene/transcript. For each transcript, it will
report : 1) Number of fragment that was used to estimate mean, median, std (see
below). 2) mean of fragment size 3) median of fragment size 4) stdev of fragment
size.

Inputs
++++++

Input BAM/SAM file
    Alignment file in BAM/SAM format.

Reference gene model
    Reference gene model in BED format. Must be strandard 12-column BED file.
    [required]

Minimum mapping quality
    Minimum mapping quality for an alignment to be considered as "uniquely
    mapped". default=30

Minimum number of fragments
    Minimum number of fragments. default=3

@ABOUT@

]]>

    </help>

    <expand macro="citations" />

</tool>
