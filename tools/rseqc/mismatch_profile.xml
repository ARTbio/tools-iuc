<tool id="rseqc_mismatch_profile" name="Mismatch Profile" version="@WRAPPER_VERSION@">
    <description>
     calculates the distribution of mismatches across reads
    </description>

    <macros>
        <import>rseqc_macros.xml</import>
    </macros>

    <expand macro="requirements" />

    <expand macro="stdio" />

    <version_command><![CDATA[mismatch_profile.py --version]]></version_command>

    <command><![CDATA[
        mismatch_profile.py -i '${input}' -o output -l ${readlength} -n ${readnum} -q ${mapq}
        ]]>
    </command>

    <inputs>
        <param name="input" type="data" label="Input .bam File" format="bam" help="(--input-file)"/>
        <param name="readlength" type="integer" value="101" label="Alignment length of read. It is usually set to the orignial read length." optional="false" help="(--read-align-length)"/>
        <param name="readnum" type="integer" label="Number of aligned reads with mismatches used to calculate the mismatch profile." value="1000000" help="(--read-num)"/>
        <param name="mapq" type="integer" label="Minimum mapping quality for an alignment to be considered as &quot;uniquely mapped&quot;." value="30" help="(--mapq)"/>
    </inputs>

    <outputs>
        <data format="pdf" name="outputpdf" from_work_dir="output.mismatch_profile.pdf" />
        <data format="xls" name="outputxls" from_work_dir="output.mismatch_profile.xls" />
        <data format="txt" name="outputr" from_work_dir="output.mismatch_profile.r" />
    </outputs>

    <tests>
        <test>
            <param name="input" value="pairend_strandspecific_51mer_hg19_chr1_1-100000.bam"/>
            <output name="outputpdf" file="output.mismatch_profile.pdf" compare="sim_size" />
            <output name="outputxls" file="output.mismatch_profile.xls"/>
            <output name="outputr" file="output.mismatch_profile.r"/>
        </test>
    </tests>

    <help><![CDATA[
mismatch_profile.py
+++++++++++++++++++

Calculate the distribution of mismatches across reads.

Note that the “MD” tag must exist in BAM file.

Inputs
++++++

Input BAM/SAM file
    Alignment file in BAM/SAM format.

Alignment length of read
    It is usually set to the orignial read length. For example, all these cigar
    strings ("101M", "68M140N33M", "53M1D48M") suggest the read alignment
    length is 101. [required]

Number of aligned reads used
    Number of aligned reads with deletions used to calculate the deletion
    profile. default=1000000

Minimum mapping quality
    Minimum mapping quality for an alignment to be considered as "uniquely
    mapped". default=30

Sample Output
++++++++++++++

.. image:: http://rseqc.sourceforge.net/_images/mismatch_profile.png
   :height: 600 px
   :width: 600 px
   :scale: 80 %

@ABOUT@

]]>

    </help>

    <expand macro="citations" />

</tool>
