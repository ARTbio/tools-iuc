<tool id="rseqc_read_NVC" name="Read NVC" version="@WRAPPER_VERSION@">
    <description>to check the nucleotide composition bias</description>

    <macros>
        <import>rseqc_macros.xml</import>
    </macros>

    <expand macro="requirements" />

    <expand macro="stdio" />

    <version_command><![CDATA[read_NVC.py --version]]></version_command>

    <command><![CDATA[
        read_NVC.py
            --input-file '${input}'
            --out-prefix output
            ${nx}
            --mapq ${mapq}
    ]]>
    </command>

    <inputs>
        <param name="input" type="data" format="bam,sam" label="input bam/sam file" help="(--input-file)"/>
        <param name="nx" type="boolean" value="false" truevalue="--nx" falsevalue="" label="Include N,X in NVC plot" help="(--nx)"/>
        <param name="mapq" type="integer" label="Minimum mapping quality (default=30)" help="Minimum phred scale mapping quality to consider a read 'uniquely mapped' (--mapq)" value="30" />
    </inputs>

    <outputs>
        <data format="xls" name="outputxls" from_work_dir="output.NVC.xls" label="${tool.name} on ${on_string} (XLS)" />
        <data format="txt" name="outputr" from_work_dir="output.NVC_plot.r" label="${tool.name} on ${on_string} (R Script)" />
        <data format="pdf" name="outputpdf" from_work_dir="output.NVC_plot.pdf" label="${tool.name} on ${on_string} (PDF)" />
    </outputs>

    <tests>
        <test>
            <param name="input" value="pairend_strandspecific_51mer_hg19_chr1_1-100000.bam" />
            <output name="outputxls" file="output.NVC.xls" />
            <output name="outputr" file="output.NVC_plot.r" />
            <output name="outputpdf" file="output.NVC_plot.pdf" compare="sim_size" />
        </test>
    </tests>

    <help><![CDATA[
read_NVC.py
+++++++++++

This module is used to check the nucleotide composition bias. Due to random priming, certain
patterns are over represented at the beginning (5'end) of reads. This bias could be easily
examined by NVC (Nucleotide versus cycle) plot. NVC plot is generated by overlaying all
reads together, then calculating nucleotide composition for each position of read
(or each sequencing cycle). In ideal condition (genome is random and RNA-seq reads is
randomly sampled from genome), we expect A%=C%=G%=T%=25% at each position of reads.

NOTE: this program expect a fixed read length

Inputs
++++++++++++++

Input BAM/SAM file
    Alignment file in BAM/SAM format.

Include N,X in NVC plot
    Plots N and X alongside A, T, C, and G in plot.

Output
++++++++++++++

This module is used to check the nucleotide composition bias. Due to random priming, certain patterns are over represented at the beginning (5'end) of reads. This bias could be easily examined by NVC (Nucleotide versus cycle) plot. NVC plot is generated by overlaying all reads together, then calculating nucleotide composition for each position of read (or each sequencing cycle). In ideal condition (genome is random and RNA-seq reads is randomly sampled from genome), we expect A%=C%=G%=T%=25% at each position of reads.


1. output.NVC.xls: plain text file, each row is position of read (or sequencing cycle), each column is nucleotide (A,C,G,T,N,X)
2. output.NVC_plot.r: R script to generate NVC plot.
3. output.NVC_plot.pdf: NVC plot.


.. image:: http://rseqc.sourceforge.net/_images/NVC_plot.png
   :height: 600 px
   :width: 600 px
   :scale: 80 %

@ABOUT@

]]>
    </help>

    <expand macro="citations" />

</tool>
