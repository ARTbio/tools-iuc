<tool id="rseqc_insertion_profile" name="Insertion Profile" version="@WRAPPER_VERSION@">
    <description>
     calculates the distribution of inserted nucleotides across reads
    </description>

    <macros>
        <import>rseqc_macros.xml</import>
    </macros>

    <expand macro="requirements" />

    <expand macro="stdio" />

    <version_command><![CDATA[insertion_profile.py --version]]></version_command>

    <command><![CDATA[
        insertion_profile.py -i '${input}' -o output -q ${mapq} -s "${layout}"
        ]]>
    </command>

    <inputs>
        <param name="input" type="data" label="Input .bam File" format="bam" help="(--input-file)"/>
        <param name="mapq" type="integer" label="Minimum mapping quality for an alignment to be considered as &quot;uniquely mapped&quot;." value="30" help="(--mapq)"/>
        <param name="layout" type="select" label="Sequencing layout" help="(--sequencing)">
            <option value="SE" selected="true">Single-end</option>
            <option value="PE">Paired-end</option>
        </param>
    </inputs>

    <outputs>
        <data format="pdf" name="outputpdf" from_work_dir="output.insertion_profile.pdf" />
        <data format="xls" name="outputxls" from_work_dir="output.insertion_profile.xls" />
        <data format="txt" name="outputr" from_work_dir="output.insertion_profile.r" />
    </outputs>

    <tests>
        <test>
            <param name="input" value="pairend_strandspecific_51mer_hg19_chr1_1-100000.bam" />
            <output name="outputpdf" file="output.insertion_profile.pdf" compare="sim_size" />
            <output name="outputxls" file="output.insertion_profile.xls" />
            <output name="outputr" file="output.insertion_profile.r" />
        </test>
    </tests>

    <help><![CDATA[
insertion_profile.py
++++++++++++++++++++

Calculate the distributions of inserted nucleotides across reads. Note that to
use this funciton, CIGAR strings within SAM/BAM file should have ‘I’ operation.

Inputs
++++++

Input BAM/SAM file
    Alignment file in BAM/SAM format.

Minimum mapping quality
    Minimum mapping quality for an alignment to be considered as "uniquely
    mapped". default=30

Sequencing layout
    Denotes whether the sequecing was single-end (SE) or paired-end (PE).

Sample Output
++++++++++++++

Read-1 insertion profile:

.. image:: http://rseqc.sourceforge.net/_images/out.insertion_profile.R1.png
   :height: 600 px
   :width: 600 px
   :scale: 80 %

Read-2 insertion profile:

.. image:: http://rseqc.sourceforge.net/_images/out.insertion_profile.R2.png
  :height: 600 px
  :width: 600 px
  :scale: 80 %

@ABOUT@

]]>
    </help>

    <expand macro="citations" />

</tool>
