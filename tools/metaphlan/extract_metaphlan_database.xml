<tool id="metaphlan" name="Extract the marker sequences" version="@TOOL_VERSION@+galaxy@VERSION_SUFFIX@">
    <description>from the MetaPhlAn database</description>
    <macros>
        <import>macros.xml</import>
    </macros>
    <expand macro="requirements">
        <requirement type="package" version="2.4.2">bowtie2</requirement>
    </expand>
    <version_command>metaphlan -v</version_command>
    <command><![CDATA[
bowtie2-inspect
    '${mapping.db.cached_db.fields.path}/${mapping.db.cached_db.fields.dbkey}'
    > '$database'
    ]]></command>
    <inputs>
        <param name="cached_db" label="Cached database with clade-specific marker genes" type="select">
            <options from_data_table="metaphlan_database"/>
        </param>
    </inputs>
    <outputs>
        <data name="database" format="fasta" label="${tool.name} on ${on_string}: Marker sequences from MetaPhlAn database" />
    </outputs>
    <tests>
    <test expect_num_outputs="1">
        <param name="cached_db" value="testdb"/>
        <output name="database">
            <assert_contents>
                <has_text text=""/>
                <has_line line=""/>
                <has_line_matching expression=""/>
                <has_n_columns n=""/>
                <has_size value="" delta=""/>
            </assert_contents>
        </output>
    </test>
    
    </tests>
    <help><![CDATA[
**What it does**

Reconstruct the marker sequences (in fasta format) from the MetaPhlAn BowTie2 database

**Outputs**

Fasta file with marker sequences.

This file can be used to add new marker sequences and then customizing the database.
    ]]></help>
    <expand macro="citations"/>
</tool>
