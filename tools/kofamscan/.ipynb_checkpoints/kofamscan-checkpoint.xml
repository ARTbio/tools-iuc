<tool id="kofam_scan" name="KofamScan" version="@TOOL_VERSION@+galaxy@VERSION_SUFFIX@">
    <description>Gene function annotation tool based on KEGG Orthology and hidden Markov model</description>
    <macros>
        <token name="@TOOL_VERSION@">1.3.0</token>    
        <token name="@VERSION_SUFFIX@">0</token>
    </macros>
    <requirements>
        <requirement type="package" version="3.3.1">hmmer</requirement>
        <requirement type="package" version="20160622">parallel</requirement>
        <requirement type="package" version="2.5.1">ruby</requirement>
    </requirements>
    <version_command><![CDATA[
kofamscan | grep "kofamScan version" | cut -d" " -f 4
    ]]></version_command>
    <command detect_errors="exit_code"><![CDATA[
./exec_annotation
'$fasta_file'
-o result
-E $e
-T $T
-f $f
-e $e
'$report_annotation'
    ]]></command>
    <configfiles>
        <configfile name="config">
            ## Path to your KO-HMM database
            ## A database can be a .hmm file, a .hal file or a directory in which
            ## .hmm files are. Omit the extension if it is .hal or .hmm file
            profile: /home/shubham/Downloads/hiwi/kofamscan/profiles
            ## Path to the KO list file
            ko_list: /home/shubham/Downloads/hiwi/kofamscan/ko_list
            ## Path to an executable file of hmmsearch
            ## You do not have to set this if it is in your $PATH
            ## hmmsearch: /usr/local/bin/hmmsearch
            ## Path to an executable file of GNU parallel
            ## You do not have to set this if it is in your $PATH
            ## parallel: /usr/local/bin/parallel
            ## Number of hmmsearch processes to be run parallelly
            cpu: 8
        </configfile>
    </configfiles>
    <inputs>
        <!--- <param argument="-p" type="file" format="hal, hmm" label=""/>
        <param argument="-k" type="file" format="txt" label=""/> --->
        <param name="fasta_file" type="data" format="fasta" label="Query file" help="A query file is a FASTA file with one or more amino acid sequences. You cannot use nucleotide sequences"/>
        <param argument="-E" type="float" label="Require E-value"/>
        <param argument="-T" type="integer" label="threshold-scale"/>
        <param argument="-f" type="select" label="Set the format of the output">
            <option value="detail">detail</option>
            <option value="detail-tsv">detail-tsv</option>
            <option value="mapper">mapper</option>
            <option value="mapper-oneline">mapper-oneline</option>
        </param>
            <help>
                detail: Default format. Gene name, assigned K number, threshold of the KO, hmmsearch score and E-value, and the definition of KO are shown. In addition, an asterisk '*' is added to the head of the line if the score is higher than the threshold.
                detail-tsv: Tab separated values for detail format.
                mapper: Format which can be used for KEGG Mapper input. It includes a gene name and an assigned K number separated by a tab. Here, an assigned K number represents a hit with score above the predefined threshold. Note that for some KOs, predefined score thresholds are not available when they are represented by a very few number of sequences in KEGG GENES.
                mapper-oneline: Similar to mapper, but when more than one KO are assigned to a gene, all assigned KO are shown in one line separated by tabs.
           </help>
        <param name="report_annotation" type="select" label="Reporting gene names (report-unannotated)?">
                <option value="--no-report-unannotated" selected="true">No</option>
                <option value="--report-unannotated">Yes</option>
        </param>
            <help>
                With --report-unannotated option, gene names are shown even when no KO is assigned (default when --format=mapper(-oneline)). With --no-report-unannotated such genes are not shown at all (default when --format=detail).
            </help>
    </inputs>
    <outputs>
        <data name="result" format="txt" label="result" from_work_dir="result"/>
    </outputs>

    <tests>
        <test>
            <output name="result">
                <assert_contents>
                    <has_text_matching expression=".+"/>
                </assert_contents>
            </output> 
        </test>
    </tests>
    <help><![CDATA[
**What it does**
KofamScan is a gene function annotation tool based on KEGG Orthology and hidden Markov model.
------
**Inputs**
A query file is a FASTA file with one or more amino acid sequences. You cannot use nucleotide sequences. Each sequence must have a unique name. A name of a sequence is a string between the header symbol (">") and the first blank character (whitespace, tab, line break, etc.). Do not put a whitespace right after ">".
------
**Outputs**
------
**References**
More information are available on `GitHub <https://github.com/takaram/kofam_scan>`_ and the `webserver <https://www.genome.jp/tools/kofamkoala/>`.
    ]]></help>
    <citations>
        <citation type="doi"></citation>
        <citation type="doi"></citation>
    </citations>
</tool>