<tool id="nanocompore_db" name="NanoComporeDB" version="@TOOL_VERSION@+@WRAPPER_VERSION@">
    <description>Process SampComp results database</description>
    <macros>
        <import>macros.xml</import>
    </macros>
    <expand macro="requirements"/>
    <command detect_errors="exit_code"><![CDATA[
mkdir results && 
tar -xf $db --strip-components 1 -C results/ && 
 python '$__tool_directory__/NanocomporeDB_process.py'
 --db-path 'results/out_SampComp.db'
 --ref-fasta '$reference'
--annotation-bed '$annotation'
    ]]></command>
    <inputs>
        <param name="reference" type="data" format="fasta" label="The reference genome used for read alignment."/>
        <param name="annotation" format="bed" type="data" label="BED file containing the annotation of the transcriptome used as reference when mapping"/>
        <param name="db" type="data" format="tar" label="SampComp Database" />
    </inputs>
    <outputs>
        <data name="output1" format="bedgraph" from_work_dir="test-data/DB_out/GMM_logit_pvalue.bedgraph" />
        <data name="output1" format="bedgraph" from_work_dir="test-data/DB_out/KS_dwell_pvalue.bedgraph" />
        <data name="output1" format="bedgraph" from_work_dir="test-data/DB_out/KS_intensity_pvalue.bedgraph" />
    </outputs>
    <tests>
        <test>
            <param name="input1" value="test-data/reference.fa"/>
            <param name="input2" value="test-data/annot.bed"/>
            <param name="db" value="test-data/DB.tar"/>
            <output name="output1" file="test-data/DB_out/GMM_logit_pvalue.bedgraph"/>
            <output name="output1" file="test-data/DB_out/KS_dwell_pvalue.bedgraph"/>
            <output name="output1" file="test-data/DB_out/KS_intensity_pvalue.bedgraph"/>
        </test>
    </tests>
    <help><![CDATA[
usage: NanocomporeDB_process.py [-h] --ref-fasta REF_FASTA [--db-path DB_PATH]
                                [--annotation-bed ANNOTATION_BED]
                                [--pvalue-types PVALUE_TYPES]
                                [--bedgraph BEDGRAPH]
                                [--pvalue-threshold PVALUE_THRESHOLD]
                                [--out-dir OUT_DIR]

save nanocompre sampcomp results as interval outputs Sample call: "python
Nannocompore-plot.py --db-path ./out_SampComp.db --ref-fasta ref.fa
--annotation-bed annot.bed--out-dir ./plots/

arguments:
  --ref-fasta REF_FASTA
                        The reference genome used for read alignment.
  --db-path DB_PATH     Path to the SampCompDB database path prefix.
  --annotation-bed ANNOTATION_BED
                        BED file containing the annotation of the
                        transcriptome used as reference when mapping
  --pvalue-types PVALUE_TYPES
                        path to the annotations
  --bedgraph BEDGRAPH   write output in BEDGRAPH format instead of BED
  --pvalue-threshold PVALUE_THRESHOLD
                        Maximum reported p-value.
  --out-dir OUT_DIR     path the plotting output directory.

**References**

@REFERENCES@
    ]]></help>
    <expand macro="citations"/>
</tool>
