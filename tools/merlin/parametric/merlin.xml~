<?xml version="1.0" encoding="utf-8"?>
<?xml version="1.0" encoding="utf-8"?>
<tool id="merlin" name="Tool for Linkage Analysis" version="0.1.0" python_template_version="3.5">
    <requirements>
        <requirement type="package">merlin</requirement>
    </requirements>
    <command detect_errors="exit_code"><![CDATA[
    merlin -p $pname -m $mname -d $dname --quiet --error --best --npl > $merlin.output
    ]]></command>
    <inputs>
	<param name="pname" type="data" format="dat" help="Set of data values" />
	<param name="mname" type="data" format="map" help="Set of map values" />
	<param name="dname" type="data" format="ped" help="Ser of pedigree values" />
    </inputs>
    <outputs>
	<data name="errors" from_work_dir="merlin.err" />
	<data name="flow" from_work_dir="merlin.flow" />
	<data name="chromosome" from_work_dir="merlin.chr" />
	<data name="merlin.output" format="lod" />
    </outputs>
    <help><![CDATA[
        MERLIN 1.1.2 - (c) 2000-2007 Goncalo Abecasis

References for this version of Merlin:

   Abecasis et al (2002) Nat Gen 30:97-101        [original citation]
   Fingerlin et al (2004) AJHG 74:432-43          [case selection for association studies]
   Abecasis and Wigginton (2005) AJHG 77:754-67   [ld modeling, parametric analyses]
   Fingerlin et al (2006) Gen Epidemiol 30:384-96 [sex-specific maps]
   Chen and Abecasis (2007) AJHG 81:913-26        [qtl association analysis, qtl simulation]


The following parameters are in effect:
                     Data File :      merlin.dat (-dname)
                 Pedigree File :      merlin.ped (-pname)
            Missing Value Code :         -99.999 (-xname)
                      Map File :      merlin.map (-mname)
            Allele Frequencies : ALL INDIVIDUALS (-f[a|e|f|m|file])
                   Random Seed :          123456 (-r9999)

Data Analysis Options
         General : --error, --information, --likelihood, --model [param.tbl]
      IBD States : --ibd, --kinship, --matrices, --extended, --select
     NPL Linkage : --npl, --pairs, --qtl, --deviates, --exp
      VC Linkage : --vc, --useCovariates, --ascertainment, --unlinked [0.00]
     Association : --infer, --assoc, --fastAssoc, --filter, --custom [cov.tbl]
     Haplotyping : --best, --sample, --all, --founders, --horizontal
   Recombination : --zero, --one, --two, --three, --singlepoint
       Positions : --steps, --maxStep, --minStep, --grid, --start, --stop
     LD Clusters : --clusters [], --distance, --rsq, --cfreq
          Limits : --bits [24], --megabytes, --minutes
     Performance : --trim, --noCoupleBits, --swap, --smallSwap
          Output : --quiet, --markerNames, --frequencies, --perFamily, --pdf,
                   --tabulate, --prefix [merlin]
      Simulation : --simulate, --reruns, --save, --trait []


FATAL ERROR - 
The datafile merlin.dat cannot be opened

Common causes for this problem are:
  * You might not have used the correct options to specify input file names,
    please check the program documentation for information on how to do this

  * The file doesn't exist or the filename might have been misspelt

  * The file exists but it is being used by another program which you will need
    to close before continuing

  * The file is larger than 2GB and you haven't compiled this application with
    large file support.




    ]]></help>
    <citations>
    </citations>
</tool>
