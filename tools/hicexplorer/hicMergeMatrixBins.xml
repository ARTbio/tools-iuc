<tool id="hicexplorer_hicmergematrixbins" name="@BINARY@" version="@WRAPPER_VERSION@.0">
    <description>Merges bins from a Hi-C matrix</description>
    <macros>
        <token name="@BINARY@">hicMergeMatrixBins</token>
        <import>macros.xml</import>
    </macros>
    <expand macro="requirements" />
    <command detect_errors="exit_code"><![CDATA[

        ln -s '$matrix' input.npz.h5 &&

        hicMergeMatrixBins
            --matrix input.npz.h5
            --numBins $numBins
            $runningWindow
            --outFileName ./out.npz.h5

]]>
    </command>
    <inputs>
        <param argument="--matrix" type="data" format="h5" label="Matrix to reduce" />
        <param argument="--numBins" type="integer" min="1" value="3" label="Number of bins to merge" />
        <param argument="--runningWindow" type="boolean" falsevalue="" truevalue="--runningWindow" label="Merge using a running window of length --numBins" />
    </inputs>
    <outputs>
        <data name="outFileName" from_work_dir="out.npz.h5" format="h5"/>
    </outputs>
    <tests>
        <test>
            <param name="matrix" value="small_test_matrix.h5" />
            <param name="numBins" value="5" />
            <output name="outFileName" file="hicMergeMatrixBins_result1.npz.h5" ftype="h5" compare="sim_size" delta="24000" />
        </test>
    </tests>
    <help><![CDATA[

**What it does**

``hicMergeMatrixBins`` is used to merge the bins of an existing matrix together. With this tool you can create out of e.g. an 100 kb 
interaction matrix a 1000 kb one:

Number of bins to merge = 10

100 kb * 10 = 1000 kb = 1 Mb

This functionality is useful especially for plotting. The higher the resolution of an interaction matrix is, the more likely it is 
to run out of memory while plotting. This is caused by the nature that we usually use sparse matrices to compute but plotting a dense
matrix is needed. Furthermore, the higher the resolution of a matrix the more detailed it is which can make it difficult to interprete. 

| For more information about HiCExplorer please consider our documentation on readthedocs.io_

.. _readthedocs.io: http://hicexplorer.readthedocs.io/en/latest/index.html
]]></help>
    <expand macro="citations" />
</tool>
