<?xml version="1.0"?>
<tool id="medaka_train" name="medaka: Train" version="@TOOL_VERSION@+@WRAPPER_VERSION@">
    <description>training program and ancillary functions</description>    
    <macros>
        <import>macros.xml</import>
    </macros>
    <expand macro="requirements"/>
    <expand macro="version_command"/>
    <command detect_errors="exit_code"><![CDATA[
        medaka train
        ## optional
        --debug
        #if $ap.train_name
            --train_name $ap.train_name
        #end if




        ## initialize 
        
        ## run
            ## optional files are transfered ans 'None' therefore the following is needed
            #if $file
                --param '$file'
            #end if
        |& tee log.txt                                      
        
        \${GALAXY_SLOTS:-4}
        \$GALAXY_MEMORY_MB
        \$GALAXY_MEMORY_MB_PER_SLOT                                    
                                      
        ]]></command>
    <inputs>

        <section name="ap" title="Advanced parameters">
            <param argument="--train_name" type="text" value="keras_train" label="Set name of training run"/>
            <expand macro="model"/>

        </section>


  --model MODEL         Model definition and initial weights .hdf, or .yml
                        with kwargs to build model. {r103_min_high_g345,
                        r103_min_high_g360, r103_prom_high_g360,
                        r103_prom_snp_g3210, r103_prom_variant_g3210,
                        r10_min_high_g303, r10_min_high_g340,
                        r941_min_fast_g303, r941_min_high_g303,
                        r941_min_high_g330, r941_min_high_g340_rle,
                        r941_min_high_g344, r941_min_high_g351,
                        r941_min_high_g360, r941_prom_fast_g303,
                        r941_prom_high_g303, r941_prom_high_g330,
                        r941_prom_high_g344, r941_prom_high_g360,
                        r941_prom_snp_g303, r941_prom_snp_g322,
                        r941_prom_variant_g303, r941_prom_variant_g322}
                        (default: None)
  --epochs EPOCHS       Maximum number of trainig epochs. (default: 5000)
  --batch_size BATCH_SIZE
                        Training batch size. (default: 100)
  --max_samples MAX_SAMPLES
                        Only train on max_samples. (default: inf)
  --mini_epochs MINI_EPOCHS
                        Reduce fraction of data per epoch by this factor
                        (default: 1)
  --seed SEED           Seed for random batch shuffling. (default: None)
  --threads_io THREADS_IO
                        Number of threads for parallel IO. (default: 1)
  --device DEVICE       GPU device to use. (default: 0)
  --optimizer {nadam,rmsprop}
                        Optimizer to use. (default: rmsprop)
  --optim_args KEY1=VAL1,KEY2=VAL2... [KEY1=VAL1,KEY2=VAL2... ...]
                        Optimizer key-word arguments. (default: None)
  --validation_split VALIDATION_SPLIT
                        Fraction of data to validate on. (default: 0.2)
  --validation_features VALIDATION_FEATURES [VALIDATION_FEATURES ...]
                        Paths to validation data (default: None)










            <param argument="" type="boolean" truevalue="" falsevalue="" checked="true" label="" help=""/>
            <param argument="" type="integer" value="" min="" max="" label="" help=""/>
            <param argument="" type="float" value="" min="" max="" label="" help=""/>
            <param argument="" type="text" value="" label="" help=""/>
            <param argument="" type="data" format="" multiple="true" label="" help=""/>
            <param argument="" type="select" multiple="false" label="" help="">
                <option value="" selected="true"></option>
                <option value=""></option>
            </param>

            <section name="" title="">
            </section>

            <conditional name="_cond" label="">
                <param name="_sel" type="select" multiple="false" label="" help="">
                    <option value=""></option>
                    <option value=""></option>
                </param>
            </conditional>

        <section name="ap" title="Advanced parameters">
        </section>
        
        <section name="oo" title="Output options">
            <param name="out" type="select" multiple="true" optional="false" label="Select output file(s)" help="">
                <option value="" selected="true"></option>
                <option value=""></option>
                <option value="log">Log</option>
            </param>            
        </section>
    </inputs>
    <outputs>
        <data name="" format="tabular" from_work_dir="" label="${tool.name} on ${on_string}: "/>
                                                                                              
        <data name="" format="tabular" from_work_dir="" label="${tool.name} on ${on_string}: ">
            <filter>'' in out</filter>
        </data>
    </outputs>
    <tests>

        <!-- #1 default -->
        <test expect_num_outputs="">
            <param name="" value=""/>           
            <output name="">
                <assert_contents>
                    <has_n_lines n=""/>
                    <has_line line=""/>
                    <has_text_matching expression=""/>
                    <has_size value="" delta=""/>
                </assert_contents>
            </output>            
        </test>                                                   
    </tests>
    <help><![CDATA[
.. class:: infomark
**What it does**
@WID@
...
**Input**
...
::
    Courier new text
**Output**
...
.. class:: infomark
**References**
@REFERENCES@
    ]]></help>
    <citations>
        <expand macro="citations"/>
    </citations>

    <expand macro="citations"/>
</tool>