<tool id="volcanoplot" name="Volcano Plot" version="0.0.1">
    <description>Create a volcano plot</description>
    <requirements>
        <requirement type="package" version="3.0.0">r-ggplot2</requirement>
        <requirement type="package" version="0.8.0">r-ggrepel</requirement>
        <requirement type="package" version="0.7.6">r-dplyr</requirement>
        <requirement type="package" version="1.20.2">r-getopt</requirement>
    </requirements>
    <version_command><![CDATA[
echo $(R --version | grep version | grep -v GNU)", ggplot2 version" $(R --vanilla --slave -e "library(ggplot2); cat(sessionInfo()\$otherPkgs\$ggplot2\$Version)" 2> /dev/null | grep -v -i "WARNING: ")
    ]]></version_command>
    <command detect_errors="exit_code"><![CDATA[

Rscript '${__tool_directory__}/volcanoplot.R'

    -i '$input'
    -a $fdr
    -p $pvalue
    -c $logfc
    -l $labels
    -s $signif
    #if $label_file:
        -f 'label_file'
    #end if
    -t $topnum
    -x $logfc_thresh

]]></command>
    <inputs>
        <param name="input" type="data" format="tabular" label="Specify an input file" />
        <param name="fdr" type="data_column" data_ref="input" label="FDR (adjusted P value)" />
        <param name="pvalue" type="data_column" data_ref="input" label="P value (raw)" />
        <param name="logfc" type="data_column" data_ref="input" label="Log Fold Change" />
        <param name="labels" type="data_column" data_ref="input" label="Labels" />
        <param name="signif" type="float" value="0.05" label="Significance threshold" help="Default: 0.05"/>
        <param name="label_file" type="data" format="tabular" optional="True" label="File of labels"/>
        <param name="topnum" type="integer" value="20" label="Number of top genes to label" help="Default: 20"/>
        <param name="logfc_thresh" type="integer" value="1" label="LogFC threshold to colour" help="Default: 1"/>
    </inputs>
    <outputs>
        <data name="plot" format="pdf" from_work_dir="out.pdf" label="Volcano plot on ${on_string}"/>
    </outputs>
    <tests>
        <test>
            <param name="input" ftype="tabular" value="input.tab"/>
            <output name="plot" value= "out.pdf" compare="sim_size" />
        </test>
    </tests>
    <help><![CDATA[
.. class:: infomark

**What it does**


-----

**Inputs**

**Outputs**

    ]]></help>
    <citations>
    </citations>
</tool>
