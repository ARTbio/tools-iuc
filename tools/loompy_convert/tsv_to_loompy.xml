<tool id="tsv_to_loompy" name="tsv to loompy converter" version="0.1.0.1">
    <description>Converts tsv file to a loom file. Loom files are a form of hd5 format</description>
    <requirements>
        <requirement type="package" version="1.9.3">numpy</requirement>
        <requirement type="package" version="2.0.16">loompy</requirement>
    </requirements>
    <version_command>python '$__tool_directory__/tsv_to_loompy.py' --VERSION | cut -d' ' -f 2'</version_command>
    <command detect_errors="exit_code"><![CDATA[
python '$__tool_directory__/tsv_to_loompy.py' -f '${data}'
    #if $rownames:
        -r
    #end if
    #if $colnames:
        -c
    #end if
    #if '$row_attr':
        --ROW_ATTR '${row_attr}'
    #end if
    #if '$col_attr':
        --COL_ATTR '${col_attr}'
    #end if
    -o '${loompyloom}'
    ]]></command>
    <inputs>
        <param name="data" type="data" format="tsv" label="Input tsv file" help="Tsv file with or without row/column names"/>
        <param name="rownames" type="boolean" label="Row names present" truevalue="true" falsevalue="false"/>
        <param name="colnames" type="boolean" label="Column names present" truevalue="true" falsevalue="false"/>
        <param name="row_attr" type="text" label="Rows represent: (If unspecified, default is 'Genes')" optional="true"/>
        <param name="col_attr" type="text" label="Columns represent: (If unspecified, default is 'Cells')" optional="true"/>
    </inputs>
    <outputs>
        <data format="loom" name="loompyloom" label="Loompy converted file"/>
    </outputs>
    <tests>
        <test>
            <param name="data" value="cols.tsv"/>
            <param name="colnames" value="true"/>
            <param name="col_attr" value="Testing"/>
            <output name="loompyloom" value="test1output.loom"/>
        </test>
        <test>
            <param name="data" value="colsrows.tsv"/>
            <param name="colnames" value="true"/>
            <param name="rownames" value="true"/>
            <param name="row_attr" value="Testing"/>
            <output name="loompyloom" value="test2output.loom"/>
        </test>
        <test>
            <param name="data" value="nocols.tsv"/>
            <param name="col_attr" value="Testing"/>
            <param name="row_attr" value="Testing2"/>
            <output name="loompyloom" value="test3output.loom"/>
        </test>
    </tests>
    <help><![CDATA[
Converts tsv file to a loom file. Loom files are a form of hd5 format, which are used by several tools. This is intended to allow ease of use for said tools via automatic conversion of existing datafiles.
    ]]></help>
</tool>
