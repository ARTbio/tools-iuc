<tool id="Illuminapairend" name="Illuminapairedend - Assembling pair-end reads" version="1.0.010">
    <description>Construct consensus reads from Illumina pair-end reads</description>
    <requirements>
        <requirement type="package" version="1.0.010">obitools</requirement>
    </requirements>
    <command>

        <![CDATA[
        illuminapairedend

        --score-min='$score'
        -r '$inputfastq3p'
        '$inputfastq5p' > '$output'

        ]]>

    </command>

    <inputs>
        <param name="inputfastq3p" type="data" format="fastq" label="Read from file" help="file of 3p (1:) Illumina pair-end reads to assemble in sanger fastq nucleic format (standard fastq)" />
        <param name="inputfastq5p" type="data" format="fastq" label="Read from file" help="file of 5p (2:) Illumina pair-end reads to assemble in sanger fastq nucleic format (standard fastq)" />
        <param name="score" type="float" value="40.0" label="minimum score for keeping aligment"/>
    </inputs>
    <outputs>
        <data format="fastq" name="output" label="${tool.name} on ${on_string}: assembly results" />
    </outputs>

    <stdio>
        <exit_code range="1"   level="fatal"   description="Error running illuminapairedend" />
    </stdio>

    <tests>
       <test>
           <param name="inputfastq3p" value="wolf_small.F.fastq" />
           <param name="inputfastq5p" value="wolf_small.R.fastq" />
           <param name="score" value="40.0" />
           <output name="output" file="illuminapairedend.output.fastq" ftype="fastq"/>
       </test>
   </tests>

    <help><![CDATA[

.. class:: warning

**Warning:**
Sequence records corresponding to the same read pair must be in the same order in the two files

--------

.. class:: infomark

**What it does**

illuminapairedend aims at aligning the two reads of a pair-end library sequenced using an Illumina platform :

\* If the two reads overlap, it returns the consensus sequence together with its quality
\* Otherwise, it concatenates sequence merging the forward read and the reversed-complemented reverse read.

The program uses as input one or two fastq sequences reads files.

\* If two files are used one of them must be specified using the -r option. Sequence records corresponding to the  same read pair must be in the same order in the two files.
\* If just one file is provided, sequence records are supposed to be all of the same length. The first half of th  e sequence is used as forward read, the second half is used as the reverse read.

illuminapairedend align the forward sequence record with the reverse complement of the reverse sequence record. The alignment algorithm takes into account the base qualities.

--------

**Project links:**

`OBITools &lt;http://www.grenoble.prabi.fr/trac/OBITools/&gt;`_

]]>
    </help>
    <citations>
            <citation type="doi">10.1111/j.1365-294X.2011.05424.x</citation>
            <citation type="doi">10.1093/nar/gkr732</citation>
            <citation type="doi">10.1186/1471-2105-2-9</citation>
            <citation type="doi">10.1186/1471-2180-10-189</citation>
            <citation type="doi">10.1186/1471-2164-11-434</citation>
        </citations>
    </tool>
