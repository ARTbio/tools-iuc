<tool id="enasearch_retrieve_data" name="Retrieve ENA data" version="@WRAPPER_VERSION@.0">
    <description>(other than taxon and project)</description>
    <macros>
        <import>macros.xml</import>
        <import>search_macros.xml</import>
    </macros>
    <expand macro="requirements"/>
    <expand macro="version"/>
    <command detect_errors="aggressive"><![CDATA[
enasearch
    retrieve_data
    #for $id in str($ids).split(',')
        --ids '$id'
    #end for
    --display '$display_opt.display'
    #if $display_opt.display == 'fasta' or $display_opt.display == 'fastq'
        #if str(range_start) != '' and str(range_stop) != ''
            --subseq_range '$display_opt.range_start'-'$display_opt.range_stop'
        #end if
    #else
        #if str($display_opt.offset) != ''
            --offset '$display_opt.offset'
        #end if
        #if str($display_opt.length) != ''
            --length '$display_opt.length'
        #end if
    #end if
    #if $expanded
        --expanded '$expanded'
    #end if
    #if $header
        --header '$header'
    #end if
    --file '$output'
    --download 'txt'
    ]]></command>
    <inputs>
        <param argument="--ids" type="text" multiple="true" label="Ids for records to return" help="Other than Taxon and Project. It can also be range of ids (e.g. ERA000010-ERA000020)"/>
        <conditional name="display_opt">
            <param argument="--display" type="select" label="Display option to specify the display format">
                <expand macro="display_options"/>
            </param>
            <expand macro="when_display_options"/>
        </conditional>
        <param argument="--expanded" type="boolean" truevalue="true" falsevalue="false" optional="true" label="Expand a CON record?"/>
        <param argument="--header" type="boolean" truevalue="true" falsevalue="false" optional="true" label="Obtain only the header of a record?"/>
    </inputs>
    <outputs>
        <data name="output" format="tabular" label="${tool.name} on ${ids}">
            <change_format>
                <when input="display_opt.display" value="fasta" format="fasta" />
                <when input="display_opt.display" value="fastq" format="fastq" />
                <when input="display_opt.display" value="html" format="html" />
                <when input="display_opt.display" value="text" format="text" />
                <when input="display_opt.display" value="xml" format="xml" />
            </change_format>
        </data>
    </outputs>
    <tests>
        <test>
            <param name="ids" value="ERA000010-ERA000020"/>
            <conditional name="display_opt">
                <param name="display" value="xml"/>
            </conditional>
            <output name="output" ftype="xml" md5="af4ba9b125b27525979ab6ea6a2b3637"/>
        </test>
        <test>
            <param name="ids" value="A00145"/>
            <conditional name="display_opt">
                <param name="display" value="fasta"/>
                <param name="range_start" value="3"/>
                <param name="range_stop" value="63"/>
            </conditional>
            <output name="output" ftype="fasta" md5="758cb77161dcf6f8cf841cb141e9277e"/>
        </test>
        <test>
            <param name="ids" value="AL513382"/>
            <conditional name="display_opt">
                <param name="display" value="text"/>
                <param name="offset" value="0"/>
                <param name="length" value="100"/>
            </conditional>
            <param name="expanded" value="true"/>
            <output name="output" md5="e77ed0fb6f75093251b6ddc98f9db835"/>
        </test>
        <test>
            <param name="ids" value="PRJEB2772,AL513382"/>
            <conditional name="display_opt">
                <param name="display" value="html"/>
            </conditional>
            <param name="header" value="true"/>
            <output name="output" md5="5357da1514a7be83d3f0b409ce502a69"/>
        </test>
    </tests>
    <help><![CDATA[
**What it does**

This tool retrieve ENA data (other than taxon and project)
    ]]></help>
    <expand macro="citations"/>
</tool>
