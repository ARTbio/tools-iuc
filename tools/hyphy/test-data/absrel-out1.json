
Analysis Description
--------------------
aBSREL (Adaptive branch-site random effects likelihood) uses an adaptive
random effects branch-site model framework to test whether each branch
has evolved under positive selection, using a procedure which infers an
optimal number of rate categories per branch.

- __Requirements__: in-frame codon alignment and a phylogenetic tree

- __Citation__: Less Is More: An Adaptive Branch-Site Random Effects Model for Efficient
Detection of Episodic Diversifying Selection (2015). Mol Biol Evol 32
(5): 1342-1353

- __Written by__: Sergei L Kosakovsky Pond, Ben Murrell, Steven Weaver and Temple iGEM /
UCSD viral evolution group

- __Contact Information__: spond@temple.edu

- __Analysis Version__: 2.0



####Choose Genetic Code

1. [**Universal**] Universal code. (Genebank transl_table=1).
2. [**Vertebrate mtDNA**] Vertebrate mitochondrial DNA code. (Genebank transl_table=2).
3. [**Yeast mtDNA**] Yeast mitochondrial DNA code. (Genebank transl_table=3).
4. [**Mold/Protozoan mtDNA**] Mold, Protozoan and Coelenterate mitochondrial DNA and the Mycloplasma/Spiroplasma code. (Genebank transl_table=4).
5. [**Invertebrate mtDNA**] Invertebrate mitochondrial DNA code. (Genebank transl_table=5).
6. [**Ciliate Nuclear**] Ciliate, Dasycladacean and Hexamita Nuclear code. (Genebank transl_table=6).
7. [**Echinoderm mtDNA**] Echinoderm mitochondrial DNA code. (Genebank transl_table=9).
8. [**Euplotid Nuclear**] Euplotid Nuclear code. (Genebank transl_table=10).
9. [**Alt. Yeast Nuclear**] Alternative Yeast Nuclear code. (Genebank transl_table=12).
10. [**Ascidian mtDNA**] Ascidian mitochondrial DNA code. (Genebank transl_table=13).
11. [**Flatworm mtDNA**] Flatworm mitochondrial DNA code. (Genebank transl_table=14).
12. [**Blepharisma Nuclear**] Blepharisma Nuclear code. (Genebank transl_table=15).
13. [**Chlorophycean mtDNA**] Chlorophycean Mitochondrial Code (transl_table=16).
14. [**Trematode mtDNA**] Trematode Mitochondrial Code (transl_table=21).
15. [**Scenedesmus obliquus mtDNA**] Scenedesmus obliquus mitochondrial Code (transl_table=22).
16. [**Thraustochytrium mtDNA**] Thraustochytrium Mitochondrial Code (transl_table=23).
17. [**Pterobranchia mtDNA**] Pterobranchia Mitochondrial Code (transl_table=24).
18. [**SR1 and Gracilibacteria**] Candidate Division SR1 and Gracilibacteria Code (transl_table=25).
19. [**Pachysolen Nuclear**] Pachysolen tannophilus Nuclear Code (transl_table=26).

>Please choose an option (or press q to cancel selection):

>Select a coding sequence alignment file (`/home/inithello/miniconda3/envs/__hyphy@2.3.12/lib/hyphy/TemplateBatchFiles/SelectionAnalyses/`) 

>Please select a tree file for the data: (`/home/inithello/miniconda3/envs/__hyphy@2.3.12/lib/hyphy/TemplateBatchFiles/SelectionAnalyses/`) 
>Loaded a multiple sequence alignment with **10** sequences, **187** codons, and **1** partitions from `/tmp/tmp3v8yJ2/job_working_directory/002/2596/working/absrel_input.fa`


####Choose the set of branches to test for selection

1. [**All**] Include all branches in the analysis
2. [**Internal**] Include all internal branches in the analysis
3. [**Leaves**] Include all leaf branches in the analysis
4. [**Unlabeled branches**] Set of 16 unlabeled branches

>Please choose an option (or press q to cancel selection):

### * Selected 16 branches for testing: `Pig, Cow, Node3, Horse, Cat, Node2, RhMonkey, Baboon, Node9, Human, Chimp, Node12, Node8, Node1, Rat, Mouse`


### Obtaining branch lengths and nucleotide substitution biases under the nucleotide GTR model
* Log(L) = -3531.96, AIC-c =  7112.14 (24 estimated parameters)

### Fitting the baseline model with a single dN/dS class per branch, and no site-to-site variation. 
* Log(L) = -3450.67, AIC-c =  6995.71 (46 estimated parameters)
* Branch-level non-synonymous/synonymous rate ratio distribution has median  1.10, and 95% of the weight in  0.00 - 10000000000.00

### Determining the optimal number of rate classes per branch using a step up procedure

|              Branch               |  Length  |  Rates   |     Max. dN/dS     |    Log(L)     |     AIC-c     |Best AIC-c so far|
|-----------------------------------|----------|----------|--------------------|---------------|---------------|-----------------|
|               Node1               |   0.29   |    2     |    2.43 (23.04%)   |   -3446.92    |    6992.43    |     6992.43     |
|               Node1               |   0.29   |    3     |    2.54 (22.00%)   |   -3446.92    |    6996.65    |     6992.43     |
|                Cat                |   0.28   |    2     |    6.13 (40.57%)   |   -3441.09    |    6984.97    |     6984.97     |
|                Cat                |   0.28   |    3     |    6.18 (39.71%)   |   -3441.08    |    6989.18    |     6984.97     |
|                Cow                |   0.25   |    2     |    7.98 (47.32%)   |   -3433.17    |    6973.38    |     6973.38     |
|                Cow                |   0.25   |    3     |    8.25 (47.13%)   |   -3433.18    |    6977.62    |     6973.38     |
|               Horse               |   0.21   |    2     |    4.10 (45.34%)   |   -3427.82    |    6966.91    |     6966.91     |
|               Horse               |   0.21   |    3     |    4.11 (45.27%)   |   -3427.82    |    6971.16    |     6966.91     |
|                Pig                |   0.19   |    2     |    2.50 (59.91%)   |   -3426.69    |    6968.89    |     6966.91     |
|               Mouse               |   0.12   |    2     |   14.51 ( 4.96%)   |   -3426.46    |    6968.43    |     6966.91     |
|               Node8               |   0.11   |    2     |   27.18 ( 9.69%)   |   -3424.48    |    6964.49    |     6964.49     |
|               Node8               |   0.11   |    3     |   27.73 ( 9.44%)   |   -3424.48    |    6968.75    |     6964.49     |
|               Node3               |   0.10   |    2     |    8.44 (28.32%)   |   -3421.23    |    6962.23    |     6962.23     |
|               Node3               |   0.10   |    3     |    8.38 (28.34%)   |   -3421.23    |    6966.50    |     6962.23     |
|               Node2               |   0.07   |    2     |   25.86 ( 9.88%)   |   -3417.21    |    6958.46    |     6958.46     |
|               Node2               |   0.07   |    3     |   26.68 ( 9.85%)   |   -3417.21    |    6962.74    |     6958.46     |
|                Rat                |   0.07   |    2     |    4.85 (30.93%)   |   -3416.43    |    6961.18    |     6958.46     |
|               Node9               |   0.03   |    2     |    0.43 (19.73%)   |   -3417.20    |    6962.72    |     6958.46     |
|              Node12               |   0.02   |    2     |    9.94 ( 5.54%)   |   -3416.36    |    6961.05    |     6958.46     |
|             RhMonkey              |   0.00   |    2     |  163.64 (100.00%)  |   -3417.21    |    6962.75    |     6958.46     |
|               Chimp               |   0.00   |    2     |  525.14 (95.31%)   |   -3417.21    |    6962.74    |     6958.46     |
|              Baboon               |   0.00   |    2     |    0.25 ( 0.00%)   |   -3417.21    |    6962.74    |     6958.46     |
|               Human               |   0.00   |    2     |    0.25 ( 1.96%)   |   -3417.21    |    6962.74    |     6958.46     |

### Rate class analyses summary
*  7 branches with **2** rate classes
*  9 branches with **1** rate classes

### Improving parameter estimates of the adaptive rate class model
* Log(L) = -3414.99, AIC-c =  6954.03 (60 estimated parameters)

### Testing selected branches for selection

|              Branch               |  Rates   |     Max. dN/dS     |      Test LRT      |Uncorrected p-value |
|-----------------------------------|----------|--------------------|--------------------|--------------------|
|               Node1               |     2    |    2.56 (21.17%)   |        1.10        |       0.23250      |
|                Cat                |     2    |    6.03 (42.26%)   |       13.05        |       0.00050      |
|                Cow                |     2    |   10.53 (46.19%)   |       24.49        |       0.00000      |
|               Horse               |     2    |    4.47 (45.00%)   |        9.84        |       0.00254      |
|                Pig                |     1    |   1.27 (100.00%)   |        0.50        |       0.32858      |
|               Mouse               |     1    |   0.54 (100.00%)   |        0.00        |       1.00000      |
|               Node8               |     2    |   33.37 ( 9.19%)   |        7.96        |       0.00656      |
|               Node3               |     2    |    8.22 (29.61%)   |        6.60        |       0.01313      |
|               Node2               |     2    |   33.28 ( 9.72%)   |        7.68        |       0.00758      |
|                Rat                |     1    |   1.16 (100.00%)   |        0.04        |       0.46204      |
|               Node9               |     1    |   0.45 (100.00%)   |        0.00        |       1.00000      |
|              Node12               |     1    |   0.34 (100.00%)   |        0.00        |       1.00000      |
|             RhMonkey              |     1    |  >1000 (100.00%)   |        1.20        |       0.21944      |
|               Chimp               |     1    |  >1000 (100.00%)   |        0.63        |       0.30350      |
|              Baboon               |     1    |   0.00 (100.00%)   |        0.00        |       1.00000      |
|               Human               |     1    |   1.00 (100.00%)   |        0.00        |       1.00000      |
----
### Adaptive branch site random effects likelihood test 
Likelihood ratio test for episodic diversifying positive selection at Holm-Bonferroni corrected _p =   0.0500_ found **3** branches under selection among **16** tested.

* Cow, p-value =  0.00003
* Cat, p-value =  0.00750
* Horse, p-value =  0.03552
