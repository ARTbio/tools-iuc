<tool id="pyega3" name="EGA Download Client" version="@VERSION@+galaxy0" python_template_version="3.5">
    <macros>
        <token name="@VERSION@">3.1.0</token>
    </macros>
    <requirements>
        <requirement type="package" version="@VERSION@">pyega3</requirement>
    </requirements>
    <configfiles>
        <configfile name="credentials"><![CDATA[
#set $password = $__user__.extra_preferences.get('ega_account|password', "")
#set $username = $__user__.extra_preferences.get('ega_account|username', "")
#if $username == "" or $password == "":
   #set $username = "ega-test-data@ebi.ac.uk"
   #set $password = "egarocks"
#end if
{
    "username": "$username",
    "password": "$password"
}
        ]]></configfile>
    </configfiles>
    <command detect_errors="exit_code"><![CDATA[
        pyega3 -cf '$credentials' datasets > '$authorized_datasets'
    ]]></command>
    <inputs>
    </inputs>
    <outputs>
        <data name="authorized_datasets" format="txt" label="${tool.name}: authorized datasets"/>
    </outputs>
    <tests>
        <test><!-- list datasets with default credentials -->
            <output name="outputdata" ftype="txt">
                <assert_contents>
                    <has_text text="EGAD00001003338"/>
                </assert_contents>
            </output>
        </test>
    </tests>
    <help><![CDATA[
        TODO: Fill in help.
    ]]></help>
</tool>
