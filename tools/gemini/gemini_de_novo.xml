<tool id="gemini_@BINARY@" name="GEMINI @BINARY@" version="@VERSION@">
    <description>Identifying potential de novo mutations</description>
    <macros>
        <import>gemini_macros.xml</import>
        <token name="@BINARY@">de_novo</token>
    </macros>
    <expand macro="requirements" />
    <expand macro="stdio" />
    <expand macro="version_command" />
    <command>
<![CDATA[
        gemini @BINARY@

            @COLUMN_SELECT@

            @CMDLN_SQL_FILTER_FILTER_OPTION@

            #if int($min_kindreds) > 0:
                --min-kindreds $min_kindreds
            #end if

            #if str($families).strip():
                --families "$families"
            #end if

            $lenient
            $allow_unaffected


            -d $d

            #if int($min_gq) > 0:
                --min-gq $min_gq
            #end if

            #if int($gt_pl_max) > -1:
                --gt-pl-max $gt_pl_max
            #end if


            "${ infile }"
            > "${ outfile }"
]]>
    </command>
    <inputs>
        <expand macro="infile" />
        <expand macro="column_filter" />
        <expand macro="filter" />
        <expand macro="min_kindreds" />
        <expand macro="family" />
        <expand macro="lenient" />
        <expand macro="unaffected" />
        <expand macro="min_sequence_depth" />
        <expand macro="min_gq" />
        <expand macro="gt_pl_max" />
    </inputs>
    <outputs>
        <data name="outfile" format="tabular" />
    </outputs>
    <tests>
        <test>
            <param name="infile" value="gemini_de_novo_input.db" ftype="gemini.sqlite" />
            <conditional name="report">
                <param name="report_selector" value="column_filter" />
                <param name="columns" value="gene,ref,alt,impact" />
            </conditional>
            <output name="outfile">
                <assert_contents>
                    <has_line_matching expression="gene&#009;ref&#009;alt&#009;impact.*" />
                </assert_contents>
            </output>
        </test>
    </tests>
    <help>
**What it does**

Assuming you have defined the familial relationships between samples when loading your VCF into GEMINI,
you can use this tool for identifying de novo (a.k.a spontaneous) mutations that arise in offspring.

    </help>
    <expand macro="citations"/>
</tool>
