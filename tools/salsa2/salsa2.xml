<tool id="salsa2" name="salsa2" version="0.1.0" python_template_version="2.7">
    <requirements>
        <requirement type="package" version="2.7">python</requirement>
        <requirement type="package" version="2.2">salsa2</requirement>
    </requirements>
    <command detect_errors="exit_code"><![CDATA[
        run_pipeline.py
        -a $fasta_in
        -l $length
        -b $bed_file
        -e $enzyme
        #if $cutoff:
            -c $cutoff
        #end if
        #if $gfa_file:
            -g $gfa_file
        #end if
        #if $iter:
            -i $iter
        #end if
        -o out
    ]]></command>
    <inputs>
        <param name="fasta_in" type="data" format="fasta" label="Initial assembly file" help="Headers must not contain ':'."/>
        <param name="length" type="data" format="fai,tsv,tabular" label="Length file" help="Fasta index file with lenght of contigs at start."/>
        <param name="bed_file" type="data" format="bed" label="Bed alignment" help="Sorted by read names"/>
        <param name="cutoff" type="integer" label="Cutoff"  optional="true" help="Minimum contig length to scaffold."/>
        <param name="gfa_file" type="data" format="gfa1, gfa2" label="GFA file" optional="true"/>
        <param name="enzyme" type="text" label="Restriction enzyme" help="Restriction enzyme sequence. If multiple were used, include all as a comma separated list without spaces (ex. 'GATC,AAGCTT')."/>
        <param name="iter" type="integer" label="Iterations" optional="true" help="Number of iterations to run"/>
    </inputs>
    <outputs>
        <data name="scaffolds_fasta" format="fasta" from_work_dir="out/scaffolds_FINAL.fasta" label="Salsa fasta assembly"/>
        <data name="scaffolds_agp" format="tabular" from_work_dir="out/scaffolds_FINAL.agp" label="Salsa agp output"/>
    </outputs>
    <tests>
        <test>
            <param name="fasta_in" value="test.fasta"/>
            <param name="length" value="test.fai"/>
            <param name="bed_file" value="test.bed"/>
            <param name="gfa_file" value="test.gfa1"/>
            <param name="enzyme" value="GATC,GANTC"/> 
            <param name="cutoff" value="1000"/>
            <param name="iter" value="3"/>
            <output name="scaffolds_fasta" file="out.fasta"/>
            <output name="scaffolds_agp" file="out.agp"/>
        </test>
    </tests>
    <help><![CDATA[
         SALSA (Simple AssembLy ScAffolder) is a scaffolding tool based on a computational method that exploits the genomic proximity information in Hi-C data sets for long range scaffolding of de novo genome assemblies.
    ]]></help>
    <citations>
        <citation type="doi">10.1101/261149</citation>
        <citation type="doi">10.1186/s12864-017-3879-z</citation>
    </citations>
</tool>